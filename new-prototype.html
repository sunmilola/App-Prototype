<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TransformIQ™ - Readiness Intelligence Platform</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-blue: #1e3a8a;
            --primary-blue-light: #3b82f6;
            --success-green: #065f46;
            --success-green-light: #10b981;
            --warning-amber: #d97706;
            --warning-amber-light: #f59e0b;
            --danger-red: #dc2626;
            --danger-red-light: #ef4444;
            --neutral-gray: #374151;
            --neutral-gray-light: #6b7280;
            --background-gray: #f8fafc;
            --border-gray: #e2e8f0;
            --white: #ffffff;
            --gradient-primary: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            --gradient-success: linear-gradient(135deg, #065f46 0%, #10b981 100%);
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--background-gray);
            color: var(--neutral-gray);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Header & Navigation */
        .header {
            background: var(--white);
            border-bottom: 1px solid var(--border-gray);
            box-shadow: var(--shadow-sm);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 24px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 70px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 24px;
            font-weight: 700;
            color: var(--primary-blue);
            text-decoration: none;
        }

        .logo i {
            font-size: 28px;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .nav-tabs {
            display: flex;
            gap: 8px;
        }

        .nav-tab {
            padding: 12px 20px;
            background: none;
            border: none;
            border-radius: 8px;
            font-weight: 500;
            color: var(--neutral-gray-light);
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-tab:hover {
            background: var(--background-gray);
            color: var(--neutral-gray);
        }

        .nav-tab.active {
            background: var(--gradient-primary);
            color: var(--white);
            box-shadow: var(--shadow-md);
        }

        .user-menu {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .security-badge {
            padding: 6px 12px;
            background: var(--success-green);
            color: var(--white);
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        /* Main Layout */
        .main-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 32px 24px;
        }

        .page-section {
            display: none;
        }

        .page-section.active {
            display: block;
        }

        /* Cards */
        .card {
            background: var(--white);
            border-radius: 12px;
            border: 1px solid var(--border-gray);
            box-shadow: var(--shadow-sm);
            transition: all 0.2s ease;
        }

        .card:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-1px);
        }

        .card-header {
            padding: 24px 24px 0 24px;
            border-bottom: 1px solid var(--border-gray);
        }

        .card-content {
            padding: 24px;
        }

        .card-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--neutral-gray);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card-subtitle {
            color: var(--neutral-gray-light);
            font-size: 14px;
            margin-bottom: 20px;
        }

        /* Buttons */
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
            text-align: center;
            justify-content: center;
        }

        .btn-primary {
            background: var(--gradient-primary);
            color: var(--white);
            box-shadow: var(--shadow-md);
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-lg);
        }

        .btn-success {
            background: var(--gradient-success);
            color: var(--white);
        }

        .btn-secondary {
            background: var(--white);
            color: var(--neutral-gray);
            border: 1px solid var(--border-gray);
        }

        .btn-secondary:hover {
            background: var(--background-gray);
        }

        .btn-danger {
            background: var(--danger-red);
            color: var(--white);
        }

        .btn-lg {
            padding: 16px 32px;
            font-size: 16px;
        }

        /* Grid Layouts */
        .grid-2 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 24px;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 24px;
        }

        .grid-4 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        /* Dashboard Styles */
        .hero-section {
            background: var(--gradient-primary);
            color: var(--white);
            padding: 48px;
            border-radius: 16px;
            margin-bottom: 32px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .hero-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.1'%3E%3Ccircle cx='7' cy='7' r='1'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E") repeat;
            opacity: 0.3;
        }

        .hero-content {
            position: relative;
            z-index: 1;
        }

        .hero-title {
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 16px;
        }

        .hero-subtitle {
            font-size: 18px;
            opacity: 0.9;
            margin-bottom: 32px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .hero-stats {
            display: flex;
            justify-content: center;
            gap: 48px;
            margin-top: 32px;
        }

        .hero-stat {
            text-align: center;
        }

        .hero-stat-value {
            font-size: 28px;
            font-weight: 700;
            display: block;
        }

        .hero-stat-label {
            font-size: 14px;
            opacity: 0.8;
        }

        .quick-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 32px;
        }

        .metric-card {
            background: var(--white);
            padding: 24px;
            border-radius: 12px;
            border: 1px solid var(--border-gray);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .metric-value {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .metric-label {
            color: var(--neutral-gray-light);
            font-size: 14px;
            font-weight: 500;
        }

        .metric-trend {
            position: absolute;
            top: 16px;
            right: 16px;
            font-size: 12px;
            padding: 4px 8px;
            border-radius: 12px;
            font-weight: 600;
        }

        .trend-up {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success-green);
        }

        .trend-down {
            background: rgba(239, 68, 68, 0.1);
            color: var(--danger-red);
        }

        /* Initiative Cards */
        .initiative-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 24px;
            margin: 24px 0;
        }

        .initiative-card {
            background: var(--white);
            border: 2px solid var(--border-gray);
            border-radius: 16px;
            padding: 24px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .initiative-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: var(--gradient-primary);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .initiative-card:hover {
            border-color: var(--primary-blue-light);
            box-shadow: var(--shadow-lg);
            transform: translateY(-4px);
        }

        .initiative-card:hover::before {
            transform: scaleX(1);
        }

        .initiative-card.selected {
            border-color: var(--primary-blue);
            background: linear-gradient(135deg, rgba(30, 58, 138, 0.02) 0%, rgba(59, 130, 246, 0.05) 100%);
        }

        .initiative-card.selected::before {
            transform: scaleX(1);
        }

        .initiative-icon {
            font-size: 48px;
            margin-bottom: 16px;
            display: block;
        }

        .initiative-name {
            font-size: 18px;
            font-weight: 600;
            color: var(--neutral-gray);
            margin-bottom: 8px;
        }

        .initiative-description {
            color: var(--neutral-gray-light);
            font-size: 14px;
            margin-bottom: 16px;
            line-height: 1.5;
        }

        .initiative-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .initiative-complexity,
        .initiative-roi {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .complexity-high {
            background: rgba(220, 38, 38, 0.1);
            color: var(--danger-red);
        }

        .complexity-medium {
            background: rgba(217, 119, 6, 0.1);
            color: var(--warning-amber);
        }

        .complexity-low {
            background: rgba(6, 95, 70, 0.1);
            color: var(--success-green);
        }

        .roi-badge {
            background: rgba(6, 95, 70, 0.1);
            color: var(--success-green);
        }

        /* Assessment Styles */
        .progress-container {
            background: var(--white);
            padding: 24px;
            border-radius: 12px;
            border: 1px solid var(--border-gray);
            margin-bottom: 24px;
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .progress-bar {
            height: 8px;
            background: var(--border-gray);
            border-radius: 4px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: var(--gradient-primary);
            transition: width 0.5s ease;
            border-radius: 4px;
        }

        .progress-steps {
            display: flex;
            justify-content: space-between;
            margin-top: 16px;
        }

        .progress-step {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            color: var(--neutral-gray-light);
        }

        .progress-step.completed {
            color: var(--success-green);
        }

        .progress-step.active {
            color: var(--primary-blue);
            font-weight: 600;
        }

        .question-card {
            background: var(--white);
            border: 1px solid var(--border-gray);
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
        }

        .question-header {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            margin-bottom: 20px;
        }

        .question-number {
            background: var(--gradient-primary);
            color: var(--white);
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 14px;
        }

        .question-text {
            font-size: 16px;
            font-weight: 600;
            color: var(--neutral-gray);
            line-height: 1.5;
        }

        .question-options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .option-button {
            padding: 16px 20px;
            border: 2px solid var(--border-gray);
            border-radius: 12px;
            background: var(--white);
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: space-between;
            text-align: left;
        }

        .option-button:hover {
            border-color: var(--primary-blue-light);
            background: rgba(59, 130, 246, 0.02);
        }

        .option-button.selected {
            border-color: var(--primary-blue);
            background: rgba(30, 58, 138, 0.05);
        }

        .option-text {
            flex: 1;
            font-weight: 500;
            color: var(--neutral-gray);
        }

        .option-score {
            background: var(--border-gray);
            color: var(--neutral-gray);
            padding: 4px 12px;
            border-radius: 16px;
            font-size: 12px;
            font-weight: 600;
        }

        .option-button.selected .option-score {
            background: var(--primary-blue);
            color: var(--white);
        }

        /* Results Styles */
        .results-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 24px;
            margin-bottom: 32px;
        }

        .score-card {
            background: var(--white);
            padding: 32px 24px;
            border-radius: 16px;
            border: 1px solid var(--border-gray);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .score-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
        }

        .score-card.high-score::before {
            background: var(--gradient-success);
        }

        .score-card.medium-score::before {
            background: linear-gradient(135deg, var(--warning-amber) 0%, var(--warning-amber-light) 100%);
        }

        .score-card.low-score::before {
            background: linear-gradient(135deg, var(--danger-red) 0%, var(--danger-red-light) 100%);
        }

        .score-value {
            font-size: 48px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .score-value.high-score {
            color: var(--success-green);
        }

        .score-value.medium-score {
            color: var(--warning-amber);
        }

        .score-value.low-score {
            color: var(--danger-red);
        }

        .score-label {
            color: var(--neutral-gray-light);
            font-weight: 500;
            margin-bottom: 16px;
        }

        .score-trend {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
            font-size: 14px;
            font-weight: 600;
        }

        .capability-results {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .capability-result {
            background: var(--white);
            border: 1px solid var(--border-gray);
            border-radius: 12px;
            padding: 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .capability-info {
            flex: 1;
        }

        .capability-name {
            font-weight: 600;
            color: var(--neutral-gray);
            margin-bottom: 4px;
        }

        .capability-details {
            font-size: 12px;
            color: var(--neutral-gray-light);
        }

        .capability-score {
            text-align: center;
            min-width: 80px;
        }

        .capability-score-value {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .capability-status {
            padding: 4px 12px;
            border-radius: 16px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-ready {
            background: rgba(6, 95, 70, 0.1);
            color: var(--success-green);
        }

        .status-caution {
            background: rgba(217, 119, 6, 0.1);
            color: var(--warning-amber);
        }

        .status-critical {
            background: rgba(220, 38, 38, 0.1);
            color: var(--danger-red);
        }

        /* Alerts */
        .alert {
            padding: 16px 20px;
            border-radius: 12px;
            margin: 16px 0;
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }

        .alert-success {
            background: rgba(6, 95, 70, 0.05);
            border-left: 4px solid var(--success-green);
            color: var(--success-green);
        }

        .alert-warning {
            background: rgba(217, 119, 6, 0.05);
            border-left: 4px solid var(--warning-amber);
            color: var(--warning-amber);
        }

        .alert-danger {
            background: rgba(220, 38, 38, 0.05);
            border-left: 4px solid var(--danger-red);
            color: var(--danger-red);
        }

        .alert-info {
            background: rgba(30, 58, 138, 0.05);
            border-left: 4px solid var(--primary-blue);
            color: var(--primary-blue);
        }

        /* Form Styles */
        .form-group {
            margin-bottom: 16px;
        }
        
        .form-label {
            display: block;
            font-weight: 600;
            margin-bottom: 6px;
            color: var(--neutral-gray);
        }
        
        .form-input {
            width: 100%;
            padding: 10px 12px;
            border: 2px solid var(--border-gray);
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.2s ease;
            background: var(--white);
        }
        
        .form-input:focus {
            outline: none;
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        .form-input:disabled {
            background: var(--background-gray);
            color: var(--neutral-gray-light);
            cursor: not-allowed;
        }
        
        .admin-content {
            display: none;
        }
        
        .admin-content.active {
            display: block;
        }
        
        .admin-tab.active {
            background: var(--gradient-primary);
            color: var(--white);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .header-content {
                padding: 0 16px;
            }

            .nav-tabs {
                display: none;
            }

            .main-container {
                padding: 16px;
            }

            .hero-title {
                font-size: 28px;
            }

            .hero-subtitle {
                font-size: 16px;
            }

            .hero-stats {
                flex-direction: column;
                gap: 24px;
            }

            .grid-2,
            .grid-3,
            .grid-4 {
                grid-template-columns: 1fr;
            }

            .initiative-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Loading States */
        .loading {
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .spinner {
            width: 16px;
            height: 16px;
            border: 2px solid var(--border-gray);
            border-top: 2px solid var(--primary-blue);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Animations */
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .slide-up {
            animation: slideUp 0.3s ease-out;
        }

        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @keyframes slideOut {
            to {
                transform: translateX(100%);
                opacity: 0;
            }
        }

        /* Utility Classes */
        .text-center { text-align: center; }
        .text-left { text-align: left; }
        .text-right { text-align: right; }
        .hidden { display: none; }
        .visible { display: block; }
        .mb-0 { margin-bottom: 0; }
        .mb-4 { margin-bottom: 16px; }
        .mb-8 { margin-bottom: 32px; }
        .mt-4 { margin-top: 16px; }
        .mt-8 { margin-top: 32px; }
        .ml-4 { margin-left: 16px; }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <a href="#" class="logo">
                <i class="fas fa-chart-line"></i>
                <span>TransformIQ™</span>
            </a>
            
            <nav class="nav-tabs">
                <button class="nav-tab active" onclick="showSection('dashboard')">
                    <i class="fas fa-home"></i>
                    Dashboard
                </button>
                <button class="nav-tab" onclick="showSection('initiatives')">
                    <i class="fas fa-target"></i>
                    Assessment Center
                </button>
                <button class="nav-tab" onclick="showSection('results')">
                    <i class="fas fa-chart-bar"></i>
                    Intelligence Hub
                </button>
                <button class="nav-tab" onclick="showSection('reports')">
                    <i class="fas fa-file-alt"></i>
                    Reports
                </button>
                <button id="admin-nav" class="nav-tab" onclick="showSection('admin')" style="display: none;">
                    <i class="fas fa-tools"></i>
                    Admin
                </button>
            </nav>
            
            <div class="user-menu">
                <div class="security-badge">
                    <i class="fas fa-shield-alt"></i>
                    SOC 2 Certified
                </div>
                <button id="admin-toggle" class="btn btn-secondary" onclick="toggleAdminMode()">
                    <i class="fas fa-cog"></i>
                    Admin Mode
                </button>
                <button class="btn btn-secondary">
                    <i class="fas fa-user"></i>
                    CIO Demo Account
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-container">
        <!-- Dashboard Section -->
        <section id="dashboard" class="page-section active">
            <div class="hero-section fade-in">
                <div class="hero-content">
                    <h1 class="hero-title">Welcome to TransformIQ™</h1>
                    <p class="hero-subtitle">
                        Evidence-based transformation readiness assessment in 30 minutes, not 30 days. 
                        Make confident go/no-go decisions with 85% prediction accuracy.
                    </p>
                    <button class="btn btn-lg" onclick="showSection('initiatives')" style="background: rgba(255,255,255,0.2); color: white; border: 2px solid rgba(255,255,255,0.3);">
                        <i class="fas fa-rocket"></i>
                        Start Assessment
                    </button>
                    <div class="hero-stats">
                        <div class="hero-stat">
                            <span class="hero-stat-value">85%</span>
                            <span class="hero-stat-label">Prediction Accuracy</span>
                        </div>
                        <div class="hero-stat">
                            <span class="hero-stat-value">30min</span>
                            <span class="hero-stat-label">Assessment Time</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="quick-metrics slide-up">
                <div class="metric-card">
                    <div class="metric-trend trend-up">+15%</div>
                    <div class="metric-value" style="color: var(--success-green);">
                        <i class="fas fa-check-circle"></i>
                        3
                    </div>
                    <div class="metric-label">Completed Assessments</div>
                </div>
                <div class="metric-card">
                    <div class="metric-trend trend-up">+8%</div>
                    <div class="metric-value" style="color: var(--warning-amber);">
                        <i class="fas fa-clock"></i>
                        2
                    </div>
                    <div class="metric-label">In Progress</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" style="color: var(--primary-blue);">
                        <i class="fas fa-chart-line"></i>
                        67%
                    </div>
                    <div class="metric-label">Average Readiness</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" style="color: var(--danger-red);">
                        <i class="fas fa-exclamation-triangle"></i>
                        3
                    </div>
                    <div class="metric-label">Critical Gaps</div>
                </div>
            </div>

            <div class="grid-2">
                <div class="card">
                    <div class="card-content">
                        <div class="card-title">
                            <i class="fas fa-lightbulb" style="color: var(--warning-amber);"></i>
                            Recent Assessment Insights
                        </div>
                        <div class="card-subtitle">Key findings from your latest evaluations</div>
                        
                        <div class="alert alert-success">
                            <i class="fas fa-check-circle"></i>
                            <div>
                                <strong>AI Automation:</strong> 72% ready - Strong data foundation enables proceed with risk mitigation strategy.
                            </div>
                        </div>
                        
                        <div class="alert alert-warning">
                            <i class="fas fa-exclamation-triangle"></i>
                            <div>
                                <strong>Cloud Migration:</strong> 45% ready - Data governance gaps require immediate attention before proceeding.
                            </div>
                        </div>
                        
                        <div class="alert alert-danger">
                            <i class="fas fa-times-circle"></i>
                            <div>
                                <strong>Customer Experience:</strong> 31% ready - Critical change management deficiencies pose high failure risk.
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-content">
                        <div class="card-title">
                            <i class="fas fa-users" style="color: var(--primary-blue);"></i>
                            Industry Benchmarks
                        </div>
                        <div class="card-subtitle">How you compare to industry peers</div>
                        
                        <div style="margin: 20px 0;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <span style="font-weight: 600;">Data Governance</span>
                                <span style="color: var(--success-green); font-weight: 600;">85th percentile</span>
                            </div>
                            <div style="background: var(--border-gray); height: 8px; border-radius: 4px; overflow: hidden;">
                                <div style="background: var(--gradient-success); height: 100%; width: 85%; border-radius: 4px;"></div>
                            </div>
                        </div>
                        
                        <div style="margin: 20px 0;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <span style="font-weight: 600;">Change Management</span>
                                <span style="color: var(--danger-red); font-weight: 600;">23rd percentile</span>
                            </div>
                            <div style="background: var(--border-gray); height: 8px; border-radius: 4px; overflow: hidden;">
                                <div style="background: linear-gradient(135deg, var(--danger-red) 0%, var(--danger-red-light) 100%); height: 100%; width: 23%; border-radius: 4px;"></div>
                            </div>
                        </div>
                        
                        <div style="margin: 20px 0;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <span style="font-weight: 600;">Technical Infrastructure</span>
                                <span style="color: var(--warning-amber); font-weight: 600;">61st percentile</span>
                            </div>
                            <div style="background: var(--border-gray); height: 8px; border-radius: 4px; overflow: hidden;">
                                <div style="background: linear-gradient(135deg, var(--warning-amber) 0%, var(--warning-amber-light) 100%); height: 100%; width: 61%; border-radius: 4px;"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card mt-8">
                <div class="card-content">
                    <div class="card-title">
                        <i class="fas fa-rocket" style="color: var(--primary-blue);"></i>
                        Quick Start Assessment
                    </div>
                    <div class="card-subtitle">Select a transformation initiative to begin evidence-based readiness evaluation</div>
                    
                    <div class="grid-4">
                        <div class="card" style="text-align: center; cursor: pointer; border: 2px dashed var(--border-gray);" onclick="startQuickAssessment('ai-automation')">
                            <div class="card-content">
                                <i class="fas fa-robot" style="font-size: 32px; color: var(--primary-blue); margin-bottom: 12px;"></i>
                                <div style="font-weight: 600; margin-bottom: 8px;">AI & Automation</div>
                                <div style="font-size: 12px; color: var(--neutral-gray-light);">12 Questions • Start Assessment</div>
                            </div>
                        </div>
                        <div class="card" style="text-align: center; cursor: pointer; border: 2px dashed var(--border-gray);" onclick="startQuickAssessment('cloud-migration')">
                            <div class="card-content">
                                <i class="fas fa-cloud" style="font-size: 32px; color: var(--primary-blue); margin-bottom: 12px;"></i>
                                <div style="font-weight: 600; margin-bottom: 8px;">Cloud Migration</div>
                                <div style="font-size: 12px; color: var(--neutral-gray-light);">11 Questions • Start Assessment</div>
                            </div>
                        </div>
                        <div class="card" style="text-align: center; cursor: pointer; border: 2px dashed var(--border-gray);" onclick="startQuickAssessment('customer-experience')">
                            <div class="card-content">
                                <i class="fas fa-users" style="font-size: 32px; color: var(--primary-blue); margin-bottom: 12px;"></i>
                                <div style="font-weight: 600; margin-bottom: 8px;">Customer Experience</div>
                                <div style="font-size: 12px; color: var(--neutral-gray-light);">9 Questions • Start Assessment</div>
                            </div>
                        </div>
                        <div class="card" style="text-align: center; cursor: pointer; border: 2px dashed var(--border-gray);" onclick="startQuickAssessment('data-analytics')">
                            <div class="card-content">
                                <i class="fas fa-chart-bar" style="font-size: 32px; color: var(--primary-blue); margin-bottom: 12px;"></i>
                                <div style="font-weight: 600; margin-bottom: 8px;">Data Analytics</div>
                                <div style="font-size: 12px; color: var(--neutral-gray-light);">8 Questions • Start Assessment</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Assessment Center Section -->
        <section id="initiatives" class="page-section">
            <div class="card mb-8">
                <div class="card-content">
                    <div class="card-title">
                        <i class="fas fa-target"></i>
                        Assessment Center
                    </div>
                    <div class="card-subtitle">
                        Select a transformation initiative for comprehensive readiness evaluation. 
                        Each assessment takes 20-30 minutes and provides immediate actionable insights.
                    </div>
                </div>
            </div>

            <div class="initiative-grid" id="initiative-grid">
                <!-- Populated by JavaScript -->
            </div>

            <div id="selected-initiative" class="card hidden mt-8">
                <div class="card-content">
                    <div class="card-title" id="selected-title" style="color: var(--primary-blue);">
                        <i id="selected-icon"></i>
                        <span id="selected-name"></span>
                    </div>
                    <div class="card-subtitle" id="selected-description"></div>
                    
                    <div class="grid-3 mb-4">
                        <div style="text-align: center; padding: 16px; background: var(--background-gray); border-radius: 8px;">
                            <div style="font-size: 18px; font-weight: 600; color: var(--primary-blue);" id="selected-complexity"></div>
                            <div style="font-size: 12px; color: var(--neutral-gray-light);">Complexity</div>
                        </div>
                        <div style="text-align: center; padding: 16px; background: var(--background-gray); border-radius: 8px;">
                            <div style="font-size: 18px; font-weight: 600; color: var(--success-green);" id="selected-roi"></div>
                            <div style="font-size: 12px; color: var(--neutral-gray-light);">Typical ROI</div>
                        </div>
                        <div style="text-align: center; padding: 16px; background: var(--background-gray); border-radius: 8px;">
                            <div style="font-size: 18px; font-weight: 600; color: var(--warning-amber);" id="selected-timeframe"></div>
                            <div style="font-size: 12px; color: var(--neutral-gray-light);">Implementation</div>
                        </div>
                    </div>

                    <div class="alert alert-info">
                        <i class="fas fa-info-circle"></i>
                        <div>
                            <strong>Assessment Overview:</strong> This evaluation covers 5-7 critical organizational capabilities 
                            with evidence-based questions. Results include readiness score, risk analysis, and actionable recommendations.
                        </div>
                    </div>

                    <div id="industry-examples" class="mb-4"></div>

                    <div class="text-center">
                        <button class="btn btn-primary btn-lg" onclick="startAssessment()">
                            <i class="fas fa-play"></i>
                            Begin Assessment
                        </button>
                    </div>
                </div>
            </div>

            <!-- Assessment Questions -->
            <div id="assessment-container" class="hidden">
                <div class="progress-container">
                    <div class="progress-header">
                        <h3 style="margin: 0;">Assessment Progress</h3>
                        <span id="progress-text">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div id="progress-fill" class="progress-fill"></div>
                    </div>
                    <div class="progress-steps">
                        <div class="progress-step completed">
                            <i class="fas fa-check-circle"></i>
                            Initiative Selected
                        </div>
                        <div class="progress-step active">
                            <i class="fas fa-clipboard-list"></i>
                            Evidence Collection
                        </div>
                        <div class="progress-step">
                            <i class="fas fa-calculator"></i>
                            Analysis & Scoring
                        </div>
                        <div class="progress-step">
                            <i class="fas fa-chart-line"></i>
                            Results & Recommendations
                        </div>
                    </div>
                </div>

                <div id="questions-container">
                    <!-- Populated by JavaScript -->
                </div>

                <div class="card text-center">
                    <div class="card-content">
                        <button class="btn btn-success btn-lg" onclick="calculateResults()" id="complete-assessment" disabled>
                            <i class="fas fa-calculator"></i>
                            Calculate Readiness Score
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Results Section -->
        <section id="results" class="page-section">
            <div class="card mb-8">
                <div class="card-content">
                    <div class="card-title">
                        <i class="fas fa-chart-bar"></i>
                        Intelligence Hub
                    </div>
                    <div class="card-subtitle">
                        Comprehensive readiness analysis with industry benchmarks, risk assessment, and actionable recommendations.
                    </div>
                </div>
            </div>

            <div id="results-placeholder" class="text-center" style="padding: 60px; color: var(--neutral-gray-light);">
                <i class="fas fa-chart-line" style="font-size: 64px; margin-bottom: 24px; color: var(--border-gray);"></i>
                <h3 style="margin-bottom: 16px;">No Assessment Results Yet</h3>
                <p style="margin-bottom: 24px;">Complete an assessment to view comprehensive readiness analysis and recommendations.</p>
                <button class="btn btn-primary" onclick="showSection('initiatives')">
                    <i class="fas fa-rocket"></i>
                    Start Assessment
                </button>
            </div>

            <div id="results-content" class="hidden">
                <div class="results-summary">
                    <div class="score-card high-score">
                        <div class="score-value high-score" id="overall-readiness">--</div>
                        <div class="score-label">Overall Readiness</div>
                        <div class="score-trend">
                            <i class="fas fa-arrow-up"></i>
                            Transformation Ready
                        </div>
                    </div>
                    <div class="score-card medium-score">
                        <div class="score-value medium-score" id="risk-score">--</div>
                        <div class="score-label">Risk Assessment</div>
                        <div class="score-trend">
                            <i class="fas fa-shield-alt"></i>
                            Mitigation Required
                        </div>
                    </div>
                    <div class="score-card low-score">
                        <div class="score-value low-score" id="confidence-level">--</div>
                        <div class="score-label">Confidence Level</div>
                        <div class="score-trend">
                            <i class="fas fa-chart-line"></i>
                            Evidence Quality
                        </div>
                    </div>
                    <div class="score-card">
                        <div class="score-value" id="industry-ranking" style="color: var(--primary-blue);">--</div>
                        <div class="score-label">Industry Ranking</div>
                        <div class="score-trend">
                            <i class="fas fa-users"></i>
                            Peer Comparison
                        </div>
                    </div>
                </div>

                <div class="grid-2">
                    <div class="card">
                        <div class="card-content">
                            <div class="card-title">
                                <i class="fas fa-exclamation-triangle" style="color: var(--danger-red);"></i>
                                Critical Risk Factors
                            </div>
                            <div class="card-subtitle">Immediate interventions required for success</div>
                            <div id="critical-risks">
                                <!-- Populated by JavaScript -->
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-content">
                            <div class="card-title">
                                <i class="fas fa-lightbulb" style="color: var(--success-green);"></i>
                                Strategic Recommendations
                            </div>
                            <div class="card-subtitle">Actionable steps to improve readiness</div>
                            <div id="recommendations">
                                <!-- Populated by JavaScript -->
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card mt-8">
                    <div class="card-content">
                        <div class="card-title">
                            <i class="fas fa-tasks"></i>
                            Capability Assessment Results
                        </div>
                        <div class="card-subtitle">Detailed breakdown of organizational readiness across all evaluated capabilities</div>
                        <div class="capability-results" id="capability-breakdown">
                            <!-- Populated by JavaScript -->
                        </div>
                    </div>
                </div>

                <div class="card mt-8">
                    <div class="card-content text-center">
                        <button class="btn btn-primary btn-lg" onclick="generateReport()">
                            <i class="fas fa-file-pdf"></i>
                            Generate Executive Report
                        </button>
                        <button class="btn btn-secondary btn-lg ml-4" onclick="scheduleConsultation()">
                            <i class="fas fa-calendar"></i>
                            Schedule Strategy Consultation
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Reports Section -->
        <section id="reports" class="page-section">
            <div class="card mb-8">
                <div class="card-content">
                    <div class="card-title">
                        <i class="fas fa-file-alt"></i>
                        Executive Reports
                    </div>
                    <div class="card-subtitle">
                        Professional assessment reports designed for C-suite decision-making and board presentations.
                    </div>
                </div>
            </div>

            <div class="grid-3">
                <div class="card">
                    <div class="card-content text-center">
                        <i class="fas fa-file-pdf" style="font-size: 48px; color: var(--danger-red); margin-bottom: 16px;"></i>
                        <h4 style="margin-bottom: 12px;">Executive Summary</h4>
                        <p style="color: var(--neutral-gray-light); margin-bottom: 20px; font-size: 14px;">
                            1-page C-suite overview with key findings, risk assessment, and go/no-go recommendation.
                        </p>
                        <button class="btn btn-secondary" onclick="generateReport('executive')">
                            <i class="fas fa-download"></i>
                            Generate Report
                        </button>
                    </div>
                </div>

                <div class="card">
                    <div class="card-content text-center">
                        <i class="fas fa-chart-bar" style="font-size: 48px; color: var(--primary-blue); margin-bottom: 16px;"></i>
                        <h4 style="margin-bottom: 12px;">Detailed Analysis</h4>
                        <p style="color: var(--neutral-gray-light); margin-bottom: 20px; font-size: 14px;">
                            Comprehensive capability breakdown with evidence, scoring rationale, and improvement roadmap.
                        </p>
                        <button class="btn btn-secondary" onclick="generateReport('detailed')">
                            <i class="fas fa-download"></i>
                            Generate Report
                        </button>
                    </div>
                </div>

                <div class="card">
                    <div class="card-content text-center">
                        <i class="fas fa-users" style="font-size: 48px; color: var(--success-green); margin-bottom: 16px;"></i>
                        <h4 style="margin-bottom: 12px;">Benchmark Analysis</h4>
                        <p style="color: var(--neutral-gray-light); margin-bottom: 20px; font-size: 14px;">
                            Industry comparison with peer rankings, best practices, and competitive positioning insights.
                        </p>
                        <button class="btn btn-secondary" onclick="generateReport('benchmark')">
                            <i class="fas fa-download"></i>
                            Generate Report
                        </button>
                    </div>
                </div>
            </div>

            <div class="card mt-8">
                <div class="card-content">
                    <div class="card-title">
                        <i class="fas fa-history"></i>
                        Assessment History
                    </div>
                    <div class="card-subtitle">Track your transformation readiness progress over time</div>
                    
                    <div style="overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse;">
                            <thead>
                                <tr style="border-bottom: 2px solid var(--border-gray);">
                                    <th style="text-align: left; padding: 12px; font-weight: 600;">Initiative</th>
                                    <th style="text-align: center; padding: 12px; font-weight: 600;">Date</th>
                                    <th style="text-align: center; padding: 12px; font-weight: 600;">Readiness</th>
                                    <th style="text-align: center; padding: 12px; font-weight: 600;">Status</th>
                                    <th style="text-align: center; padding: 12px; font-weight: 600;">Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr style="border-bottom: 1px solid var(--border-gray);">
                                    <td style="padding: 12px;">
                                        <div style="display: flex; align-items: center; gap: 8px;">
                                            <i class="fas fa-robot" style="color: var(--primary-blue);"></i>
                                            <span style="font-weight: 500;">AI Implementation & Automation</span>
                                        </div>
                                    </td>
                                    <td style="text-align: center; padding: 12px; color: var(--neutral-gray-light);">Dec 15, 2024</td>
                                    <td style="text-align: center; padding: 12px;">
                                        <span style="font-weight: 600; color: var(--warning-amber);">72%</span>
                                    </td>
                                    <td style="text-align: center; padding: 12px;">
                                        <span class="capability-status status-caution">Proceed with Caution</span>
                                    </td>
                                    <td style="text-align: center; padding: 12px;">
                                        <button class="btn btn-secondary" style="padding: 6px 12px; font-size: 12px;">
                                            <i class="fas fa-download"></i>
                                            Report
                                        </button>
                                    </td>
                                </tr>
                                <tr style="border-bottom: 1px solid var(--border-gray);">
                                    <td style="padding: 12px;">
                                        <div style="display: flex; align-items: center; gap: 8px;">
                                            <i class="fas fa-cloud" style="color: var(--primary-blue);"></i>
                                            <span style="font-weight: 500;">Cloud Migration & Modernization</span>
                                        </div>
                                    </td>
                                    <td style="text-align: center; padding: 12px; color: var(--neutral-gray-light);">Dec 10, 2024</td>
                                    <td style="text-align: center; padding: 12px;">
                                        <span style="font-weight: 600; color: var(--danger-red);">45%</span>
                                    </td>
                                    <td style="text-align: center; padding: 12px;">
                                        <span class="capability-status status-critical">Address Gaps First</span>
                                    </td>
                                    <td style="text-align: center; padding: 12px;">
                                        <button class="btn btn-secondary" style="padding: 6px 12px; font-size: 12px;">
                                            <i class="fas fa-download"></i>
                                            Report
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td style="padding: 12px;">
                                        <div style="display: flex; align-items: center; gap: 8px;">
                                            <i class="fas fa-users" style="color: var(--primary-blue);"></i>
                                            <span style="font-weight: 500;">Customer Experience Platform</span>
                                        </div>
                                    </td>
                                    <td style="text-align: center; padding: 12px; color: var(--neutral-gray-light);">Dec 5, 2024</td>
                                    <td style="text-align: center; padding: 12px;">
                                        <span style="font-weight: 600; color: var(--success-green);">81%</span>
                                    </td>
                                    <td style="text-align: center; padding: 12px;">
                                        <span class="capability-status status-ready">Ready to Proceed</span>
                                    </td>
                                    <td style="text-align: center; padding: 12px;">
                                        <button class="btn btn-secondary" style="padding: 6px 12px; font-size: 12px;">
                                            <i class="fas fa-download"></i>
                                            Report
                                        </button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <!-- Admin Section -->
        <section id="admin" class="page-section">
            <div class="card mb-8">
                <div class="card-content">
                    <div class="card-title">
                        <i class="fas fa-tools" style="color: var(--warning-amber);"></i>
                        Platform Administration
                    </div>
                    <div class="card-subtitle">
                        Manage questionnaires, initiatives, scoring models, and platform configuration.
                    </div>
                    <div class="alert alert-warning mt-4">
                        <i class="fas fa-exclamation-triangle"></i>
                        <div>
                            <strong>Admin Mode Active:</strong> You have administrative access to modify platform content and configuration. 
                            Changes will affect all future assessments.
                        </div>
                    </div>
                </div>
            </div>

            <!-- Admin Navigation Tabs -->
            <div class="card mb-8">
                <div class="card-content">
                    <div style="display: flex; gap: 8px; margin-bottom: 24px;">
                        <button class="btn btn-secondary admin-tab active" onclick="showAdminTab('questionnaires')">
                            <i class="fas fa-clipboard-list"></i>
                            Questionnaires
                        </button>
                        <button class="btn btn-secondary admin-tab" onclick="showAdminTab('initiatives')">
                            <i class="fas fa-rocket"></i>
                            Initiatives
                        </button>
                        <button class="btn btn-secondary admin-tab" onclick="showAdminTab('scoring')">
                            <i class="fas fa-calculator"></i>
                            Scoring Models
                        </button>
                        <button class="btn btn-secondary admin-tab" onclick="showAdminTab('analytics')">
                            <i class="fas fa-chart-line"></i>
                            Platform Analytics
                        </button>
                        <button class="btn btn-secondary admin-tab" onclick="showAdminTab('settings')">
                            <i class="fas fa-cog"></i>
                            Settings
                        </button>
                    </div>

                    <!-- Questionnaire Management -->
                    <div id="admin-questionnaires" class="admin-content active">
                        <div class="grid-2">
                            <!-- Current Questionnaires Overview -->
                            <div class="card">
                                <div class="card-content">
                                    <h4 style="margin-bottom: 16px; color: var(--neutral-gray);">
                                        <i class="fas fa-list"></i>
                                        Questionnaire Overview
                                    </h4>
                                    <div id="questionnaire-summary">
                                        <!-- Populated by JavaScript -->
                                    </div>
                                </div>
                            </div>

                            <!-- Quick Stats -->
                            <div class="card">
                                <div class="card-content">
                                    <h4 style="margin-bottom: 16px; color: var(--neutral-gray);">
                                        <i class="fas fa-chart-bar"></i>
                                        Content Statistics
                                    </h4>
                                    <div class="grid-2" id="content-stats">
                                        <div style="text-align: center; padding: 16px; background: var(--background-gray); border-radius: 8px;">
                                            <div style="font-size: 24px; font-weight: 700; color: var(--success-green);" id="total-capabilities">--</div>
                                            <div style="font-size: 12px; color: var(--neutral-gray-light);">Capabilities</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Add New Question Form -->
                        <div class="card mt-8">
                            <div class="card-content">
                                <h4 style="margin-bottom: 20px; color: var(--neutral-gray);">
                                    <i class="fas fa-plus"></i>
                                    Add New Question
                                </h4>
                                
                                <div class="grid-2">
                                    <div class="form-group">
                                        <label class="form-label">Initiative:</label>
                                        <select id="admin-initiative" class="form-input">
                                            <option value="">Select Initiative</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Capability:</label>
                                        <select id="admin-capability" class="form-input" disabled>
                                            <option value="">Select Capability</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label class="form-label">Question Text:</label>
                                    <textarea id="admin-question" class="form-input" rows="3" 
                                              placeholder="Enter your evidence-based question here..."></textarea>
                                </div>

                                <div class="grid-2">
                                    <div class="form-group">
                                        <label class="form-label">Question Type:</label>
                                        <select id="admin-type" class="form-input">
                                            <option value="evidence">Evidence-Based (0-100 scale)</option>
                                            <option value="adoption">Adoption Level (10-95 scale)</option>
                                            <option value="maturity">Maturity Level (1-5 scale)</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Question Weight:</label>
                                        <select id="admin-weight" class="form-input">
                                            <option value="1">Low Impact (1)</option>
                                            <option value="2">Minor Impact (2)</option>
                                            <option value="3" selected>Standard Impact (3)</option>
                                            <option value="4">High Impact (4)</option>
                                            <option value="5">Critical Impact (5)</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="card mt-4" style="background: var(--background-gray);">
                                    <div class="card-content">
                                        <h5 style="margin-bottom: 16px;">Answer Options:</h5>
                                        <div id="admin-options">
                                            <!-- Populated by JavaScript -->
                                        </div>
                                    </div>
                                </div>

                                <div style="text-align: center; margin-top: 24px;">
                                    <button class="btn btn-primary" onclick="saveQuestion()">
                                        <i class="fas fa-save"></i>
                                        Save Question
                                    </button>
                                    <button class="btn btn-secondary ml-4" onclick="resetQuestionForm()">
                                        <i class="fas fa-undo"></i>
                                        Reset Form
                                    </button>
                                    <button class="btn btn-secondary ml-4" onclick="previewQuestion()">
                                        <i class="fas fa-eye"></i>
                                        Preview Question
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Question Management -->
                        <div class="card mt-8">
                            <div class="card-content">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                                    <h4 style="color: var(--neutral-gray); margin: 0;">
                                        <i class="fas fa-edit"></i>
                                        Manage Existing Questions
                                    </h4>
                                    <div>
                                        <select id="filter-initiative" class="form-input" style="width: auto; margin-right: 12px;">
                                            <option value="">All Initiatives</option>
                                        </select>
                                        <button class="btn btn-secondary" onclick="refreshQuestionList()">
                                            <i class="fas fa-sync"></i>
                                            Refresh
                                        </button>
                                    </div>
                                </div>
                                <div id="question-management-list">
                                    <!-- Populated by JavaScript -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Initiative Management -->
                    <div id="admin-initiatives" class="admin-content">
                        <div class="grid-2">
                            <!-- Add New Initiative -->
                            <div class="card">
                                <div class="card-content">
                                    <h4 style="margin-bottom: 20px; color: var(--neutral-gray);">
                                        <i class="fas fa-plus"></i>
                                        Create New Initiative
                                    </h4>
                                    
                                    <div class="form-group">
                                        <label class="form-label">Initiative ID:</label>
                                        <input type="text" id="new-initiative-id" class="form-input" 
                                               placeholder="e.g., blockchain-implementation">
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="form-label">Initiative Name:</label>
                                        <input type="text" id="new-initiative-name" class="form-input" 
                                               placeholder="e.g., Blockchain & Distributed Ledger">
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="form-label">Icon Class:</label>
                                        <input type="text" id="new-initiative-icon" class="form-input" 
                                               placeholder="e.g., fas fa-link" value="fas fa-rocket">
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="form-label">Description:</label>
                                        <textarea id="new-initiative-description" class="form-input" rows="3"
                                                  placeholder="Comprehensive description of the transformation initiative..."></textarea>
                                    </div>
                                    
                                    <div class="grid-2">
                                        <div class="form-group">
                                            <label class="form-label">Complexity:</label>
                                            <select id="new-initiative-complexity" class="form-input">
                                                <option value="Low">Low</option>
                                                <option value="Medium" selected>Medium</option>
                                                <option value="Medium-High">Medium-High</option>
                                                <option value="High">High</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Category:</label>
                                            <input type="text" id="new-initiative-category" class="form-input" 
                                                   placeholder="e.g., Emerging Technology">
                                        </div>
                                    </div>
                                    
                                    <div class="grid-2">
                                        <div class="form-group">
                                            <label class="form-label">Typical ROI:</label>
                                            <input type="text" id="new-initiative-roi" class="form-input" 
                                                   placeholder="e.g., 200-400%">
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Timeframe:</label>
                                            <input type="text" id="new-initiative-timeframe" class="form-input" 
                                                   placeholder="e.g., 9-18 months">
                                        </div>
                                    </div>
                                    
                                    <button class="btn btn-primary" onclick="createInitiative()">
                                        <i class="fas fa-plus"></i>
                                        Create Initiative
                                    </button>
                                </div>
                            </div>

                            <!-- Initiative Overview -->
                            <div class="card">
                                <div class="card-content">
                                    <h4 style="margin-bottom: 16px; color: var(--neutral-gray);">
                                        <i class="fas fa-list"></i>
                                        Current Initiatives
                                    </h4>
                                    <div id="initiative-overview">
                                        <!-- Populated by JavaScript -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Scoring Models -->
                    <div id="admin-scoring" class="admin-content">
                        <div class="card">
                            <div class="card-content">
                                <h4 style="margin-bottom: 20px; color: var(--neutral-gray);">
                                    <i class="fas fa-calculator"></i>
                                    Scoring Model Configuration
                                </h4>
                                
                                <div class="alert alert-info">
                                    <i class="fas fa-info-circle"></i>
                                    <div>
                                        <strong>Scoring Algorithm:</strong> Modify how readiness scores are calculated across different question types and capability weights.
                                    </div>
                                </div>

                                <div class="grid-2">
                                    <div class="card" style="background: var(--background-gray);">
                                        <div class="card-content">
                                            <h5>Readiness Thresholds</h5>
                                            <div class="form-group">
                                                <label class="form-label">Ready (Green):</label>
                                                <input type="number" id="threshold-ready" class="form-input" value="70" min="0" max="100">
                                                <small style="color: var(--neutral-gray-light);">Minimum score for "ready to proceed"</small>
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Caution (Yellow):</label>
                                                <input type="number" id="threshold-caution" class="form-input" value="50" min="0" max="100">
                                                <small style="color: var(--neutral-gray-light);">Minimum score for "proceed with caution"</small>
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Critical (Red):</label>
                                                <input type="number" id="threshold-critical" class="form-input" value="40" min="0" max="100">
                                                <small style="color: var(--neutral-gray-light);">Below this score is "critical risk"</small>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="card" style="background: var(--background-gray);">
                                        <div class="card-content">
                                            <h5>Weight Multipliers</h5>
                                            <div class="form-group">
                                                <label class="form-label">Evidence Questions:</label>
                                                <input type="number" id="weight-evidence" class="form-input" value="1.0" step="0.1" min="0" max="3">
                                                <small style="color: var(--neutral-gray-light);">Multiplier for evidence-based questions</small>
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Adoption Questions:</label>
                                                <input type="number" id="weight-adoption" class="form-input" value="0.9" step="0.1" min="0" max="3">
                                                <small style="color: var(--neutral-gray-light);">Multiplier for adoption percentage questions</small>
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Maturity Questions:</label>
                                                <input type="number" id="weight-maturity" class="form-input" value="20" step="1" min="10" max="30">
                                                <small style="color: var(--neutral-gray-light);">Multiplier for maturity level questions (1-5 scale)</small>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div style="text-align: center; margin-top: 24px;">
                                    <button class="btn btn-primary" onclick="updateScoringModel()">
                                        <i class="fas fa-save"></i>
                                        Update Scoring Model
                                    </button>
                                    <button class="btn btn-secondary ml-4" onclick="resetScoringModel()">
                                        <i class="fas fa-undo"></i>
                                        Reset to Defaults
                                    </button>
                                    <button class="btn btn-secondary ml-4" onclick="testScoringModel()">
                                        <i class="fas fa-calculator"></i>
                                        Test with Sample Data
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Platform Analytics -->
                    <div id="admin-analytics" class="admin-content">
                        <div class="grid-3">
                            <div class="metric-card">
                                <div class="metric-value" style="color: var(--primary-blue);">
                                    <i class="fas fa-users"></i>
                                    127
                                </div>
                                <div class="metric-label">Total Assessments</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-value" style="color: var(--success-green);">
                                    <i class="fas fa-chart-line"></i>
                                    68%
                                </div>
                                <div class="metric-label">Avg Readiness Score</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-value" style="color: var(--warning-amber);">
                                    <i class="fas fa-clock"></i>
                                    23min
                                </div>
                                <div class="metric-label">Avg Assessment Time</div>
                            </div>
                        </div>

                        <div class="card mt-8">
                            <div class="card-content">
                                <h4 style="margin-bottom: 20px; color: var(--neutral-gray);">
                                    <i class="fas fa-chart-bar"></i>
                                    Assessment Analytics
                                </h4>
                                
                                <div style="background: var(--background-gray); padding: 20px; border-radius: 8px; text-align: center;">
                                    <i class="fas fa-chart-line" style="font-size: 48px; color: var(--border-gray); margin-bottom: 16px;"></i>
                                    <h5 style="color: var(--neutral-gray-light);">Analytics Dashboard Coming Soon</h5>
                                    <p style="color: var(--neutral-gray-light); margin: 0;">
                                        Detailed analytics including completion rates, question performance, and user behavior insights.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Platform Settings -->
                    <div id="admin-settings" class="admin-content">
                        <div class="grid-2">
                            <div class="card">
                                <div class="card-content">
                                    <h4 style="margin-bottom: 20px; color: var(--neutral-gray);">
                                        <i class="fas fa-cog"></i>
                                        Platform Configuration
                                    </h4>
                                    
                                    <div class="form-group">
                                        <label class="form-label">Platform Name:</label>
                                        <input type="text" id="platform-name" class="form-input" value="TransformIQ™">
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="form-label">Tagline:</label>
                                        <input type="text" id="platform-tagline" class="form-input" 
                                               value="Readiness Intelligence Platform">
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="form-label">Company Name:</label>
                                        <input type="text" id="company-name" class="form-input" 
                                               value="Enterprise Transformation Consulting">
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="form-label">Support Email:</label>
                                        <input type="email" id="support-email" class="form-input" 
                                               value="support@transformiq.com">
                                    </div>
                                </div>
                            </div>

                            <div class="card">
                                <div class="card-content">
                                    <h4 style="margin-bottom: 20px; color: var(--neutral-gray);">
                                        <i class="fas fa-download"></i>
                                        Data Management
                                    </h4>
                                    
                                    <div style="margin-bottom: 20px;">
                                        <button class="btn btn-primary" onclick="exportPlatformData()">
                                            <i class="fas fa-download"></i>
                                            Export All Configuration
                                        </button>
                                        <p style="font-size: 12px; color: var(--neutral-gray-light); margin: 8px 0 0 0;">
                                            Downloads complete platform configuration including all initiatives, questions, and settings.
                                        </p>
                                    </div>
                                    
                                    <div style="margin-bottom: 20px;">
                                        <button class="btn btn-secondary" onclick="document.getElementById('import-file').click()">
                                            <i class="fas fa-upload"></i>
                                            Import Configuration
                                        </button>
                                        <input type="file" id="import-file" style="display: none;" accept=".json" onchange="importPlatformData(event)">
                                        <p style="font-size: 12px; color: var(--neutral-gray-light); margin: 8px 0 0 0;">
                                            Upload previously exported configuration file to restore platform state.
                                        </p>
                                    </div>
                                    
                                    <div style="margin-bottom: 20px;">
                                        <button class="btn btn-danger" onclick="resetPlatformData()">
                                            <i class="fas fa-trash"></i>
                                            Reset to Defaults
                                        </button>
                                        <p style="font-size: 12px; color: var(--neutral-gray-light); margin: 8px 0 0 0;">
                                            <strong>Warning:</strong> This will delete all custom content and restore factory settings.
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <script>
        // Global State Management
        let appState = {
            currentSection: 'dashboard',
            selectedInitiative: null,
            assessmentData: {},
            results: {},
            progress: 0,
            adminMode: false,
            currentAdminTab: 'questionnaires'
        };

        // Complete Initiative Data Model with Full Question Sets
        const initiatives = {
            'ai-automation': {
                id: 'ai-automation',
                name: 'AI Implementation & Intelligent Automation',
                icon: 'fas fa-robot',
                description: 'Deploy artificial intelligence and robotic process automation to optimize operations, enhance decision-making, and create competitive advantages through intelligent systems.',
                category: 'Advanced Technology',
                complexity: 'High',
                complexityColor: 'complexity-high',
                typicalROI: '300-500%',
                timeframe: '12-24 months',
                industryExamples: {
                    manufacturing: 'Predictive maintenance reducing unplanned downtime by 40% and saving $2.3M annually',
                    financial: 'Automated fraud detection preventing $50M in losses while reducing false positives by 60%',
                    healthcare: 'AI-powered diagnostics improving accuracy by 25% and reducing diagnosis time by 50%',
                    retail: 'Intelligent inventory management reducing stockouts by 35% and overstock by 28%'
                },
                capabilities: [
                    {
                        name: 'Data Governance & Quality',
                        weight: 5,
                        requiredScore: 75,
                        questions: [
                            {
                                id: 'ai_dg1',
                                text: 'How comprehensive is your data quality monitoring and governance framework?',
                                type: 'evidence',
                                weight: 4,
                                options: [
                                    { text: 'No systematic data quality monitoring in place', score: 10 },
                                    { text: 'Basic data quality checks on critical datasets only', score: 30 },
                                    { text: 'Regular monitoring across most systems with some automation', score: 60 },
                                    { text: 'Comprehensive automated monitoring with real-time alerts', score: 85 },
                                    { text: 'Advanced data governance with predictive quality management', score: 95 }
                                ]
                            },
                            {
                                id: 'ai_dg2',
                                text: 'What percentage of your enterprise data is readily accessible for AI model training?',
                                type: 'adoption',
                                weight: 5,
                                options: [
                                    { text: 'Less than 25% - Most data is siloed or inaccessible', score: 15 },
                                    { text: '25-50% - Some integration exists but major gaps remain', score: 35 },
                                    { text: '50-75% - Good integration with some remaining silos', score: 65 },
                                    { text: '75-90% - Most data is integrated and accessible', score: 85 },
                                    { text: 'Over 90% - Comprehensive data integration platform', score: 95 }
                                ]
                            },
                            {
                                id: 'ai_dg3',
                                text: 'How mature is your data privacy and AI ethics framework?',
                                type: 'maturity',
                                weight: 4,
                                options: [
                                    { text: 'Basic compliance with minimal AI-specific policies', score: 1 },
                                    { text: 'Standard privacy policies with some AI considerations', score: 2 },
                                    { text: 'Comprehensive framework with regular ethics reviews', score: 3 },
                                    { text: 'Advanced governance with AI bias detection and mitigation', score: 4 },
                                    { text: 'Industry-leading responsible AI practices with continuous monitoring', score: 5 }
                                ]
                            }
                        ]
                    },
                    {
                        name: 'Technical Infrastructure',
                        weight: 4,
                        requiredScore: 70,
                        questions: [
                            {
                                id: 'ai_ti1',
                                text: 'How would you rate your organization\'s cloud computing and scalable infrastructure capabilities?',
                                type: 'maturity',
                                weight: 5,
                                options: [
                                    { text: 'Primarily on-premises with limited cloud adoption', score: 1 },
                                    { text: 'Basic cloud services with manual scaling processes', score: 2 },
                                    { text: 'Hybrid cloud with some automated scaling capabilities', score: 3 },
                                    { text: 'Advanced cloud-native architecture with auto-scaling', score: 4 },
                                    { text: 'Multi-cloud optimization with AI-powered resource management', score: 5 }
                                ]
                            },
                            {
                                id: 'ai_ti2',
                                text: 'What is your current AI/ML development and deployment infrastructure maturity?',
                                type: 'evidence',
                                weight: 5,
                                options: [
                                    { text: 'No dedicated AI infrastructure - would need external services', score: 10 },
                                    { text: 'Basic cloud AI services with limited customization', score: 30 },
                                    { text: 'Moderate infrastructure with some MLOps capabilities', score: 60 },
                                    { text: 'Advanced platform with automated ML pipelines', score: 85 },
                                    { text: 'Enterprise-grade AI platform with full MLOps and governance', score: 95 }
                                ]
                            },
                            {
                                id: 'ai_ti3',
                                text: 'How robust is your cybersecurity framework for AI systems?',
                                type: 'adoption',
                                weight: 4,
                                options: [
                                    { text: 'Standard security - no AI-specific protections', score: 15 },
                                    { text: 'Basic AI security with some model protection', score: 35 },
                                    { text: 'Good security framework covering most AI risks', score: 65 },
                                    { text: 'Comprehensive AI security with advanced threat detection', score: 85 },
                                    { text: 'Industry-leading AI security with real-time monitoring', score: 95 }
                                ]
                            }
                        ]
                    },
                    {
                        name: 'AI Skills & Expertise',
                        weight: 4,
                        requiredScore: 60,
                        questions: [
                            {
                                id: 'ai_sk1',
                                text: 'What is your organization\'s current AI and machine learning expertise level?',
                                type: 'adoption',
                                weight: 5,
                                options: [
                                    { text: 'No AI expertise - Would need to hire external resources', score: 10 },
                                    { text: 'Basic understanding - Some staff familiar with concepts', score: 30 },
                                    { text: 'Moderate expertise - Can implement basic AI solutions', score: 60 },
                                    { text: 'Strong capabilities - Experienced AI development team', score: 85 },
                                    { text: 'Advanced expertise - Industry-leading AI capabilities', score: 95 }
                                ]
                            },
                            {
                                id: 'ai_sk2',
                                text: 'How effective is your organization at attracting and retaining AI talent?',
                                type: 'evidence',
                                weight: 4,
                                options: [
                                    { text: 'Significant challenges - High turnover and recruitment difficulties', score: 10 },
                                    { text: 'Some challenges - Competing for limited talent pool', score: 30 },
                                    { text: 'Moderate success - Can recruit with effort and competitive packages', score: 60 },
                                    { text: 'Strong attraction - Recognized as preferred AI employer', score: 85 },
                                    { text: 'Top talent destination - Industry-leading AI team', score: 95 }
                                ]
                            }
                        ]
                    },
                    {
                        name: 'Change Management & Adoption',
                        weight: 5,
                        requiredScore: 80,
                        questions: [
                            {
                                id: 'ai_cm1',
                                text: 'How effective is your organization at managing technology-driven change initiatives?',
                                type: 'evidence',
                                weight: 5,
                                options: [
                                    { text: 'Poor track record - Most initiatives fail or face resistance', score: 10 },
                                    { text: 'Mixed results - Some success but inconsistent adoption', score: 30 },
                                    { text: 'Generally successful with structured change management', score: 60 },
                                    { text: 'Strong track record with comprehensive change programs', score: 85 },
                                    { text: 'Exceptional change capability with proactive culture transformation', score: 95 }
                                ]
                            },
                            {
                                id: 'ai_cm2',
                                text: 'What is the level of AI acceptance and enthusiasm across your organization?',
                                type: 'adoption',
                                weight: 4,
                                options: [
                                    { text: 'Significant resistance - Fear of job displacement', score: 15 },
                                    { text: 'Mixed reactions - Some enthusiasm, some resistance', score: 35 },
                                    { text: 'Generally positive - Understanding of AI benefits', score: 65 },
                                    { text: 'High enthusiasm - Proactive adoption and learning', score: 85 },
                                    { text: 'AI-first culture - Organization-wide excitement and adoption', score: 95 }
                                ]
                            }
                        ]
                    },
                    {
                        name: 'IT-Business Collaboration',
                        weight: 4,
                        requiredScore: 75,
                        questions: [
                            {
                                id: 'ai_itb1',
                                text: 'How would you characterize the collaboration between IT and business units on strategic initiatives?',
                                type: 'adoption',
                                weight: 4,
                                options: [
                                    { text: 'Minimal collaboration - IT and business work in isolation', score: 15 },
                                    { text: 'Basic coordination - Quarterly reviews and project updates', score: 35 },
                                    { text: 'Regular collaboration - Monthly strategic planning sessions', score: 65 },
                                    { text: 'Strong partnership - Weekly collaboration with shared goals', score: 85 },
                                    { text: 'Integrated teams - Daily partnership with shared accountability', score: 95 }
                                ]
                            },
                            {
                                id: 'ai_itb2',
                                text: 'How mature is your business case development process for AI initiatives?',
                                type: 'maturity',
                                weight: 3,
                                options: [
                                    { text: 'Ad-hoc business cases with limited ROI analysis', score: 1 },
                                    { text: 'Standard business case template with basic metrics', score: 2 },
                                    { text: 'Comprehensive cases with detailed cost-benefit analysis', score: 3 },
                                    { text: 'Advanced modeling with risk assessment and scenarios', score: 4 },
                                    { text: 'Sophisticated cases with continuous value tracking', score: 5 }
                                ]
                            }
                        ]
                    }
                ]
            },
            'cloud-migration': {
                id: 'cloud-migration',
                name: 'Enterprise Cloud Migration & Modernization',
                icon: 'fas fa-cloud',
                description: 'Migrate critical systems to cloud infrastructure while modernizing applications for scalability, security, and operational excellence.',
                category: 'Infrastructure Transformation',
                complexity: 'Medium-High',
                complexityColor: 'complexity-medium',
                typicalROI: '200-400%',
                timeframe: '6-18 months',
                industryExamples: {
                    manufacturing: 'Cloud-native ERP reducing operational costs by 30% and improving agility',
                    financial: 'Multi-cloud strategy enabling 99.99% uptime and regulatory compliance',
                    healthcare: 'HIPAA-compliant cloud infrastructure supporting telemedicine expansion',
                    retail: 'Elastic cloud architecture handling 500% traffic spikes during peak seasons'
                },
                capabilities: [
                    {
                        name: 'Security & Compliance Framework',
                        weight: 5,
                        requiredScore: 85,
                        questions: [
                            {
                                id: 'cloud_sc1',
                                text: 'How mature is your cloud security and compliance framework?',
                                type: 'maturity',
                                weight: 5,
                                options: [
                                    { text: 'Basic cloud security with limited compliance controls', score: 1 },
                                    { text: 'Standard security policies with some compliance automation', score: 2 },
                                    { text: 'Comprehensive security framework with regular audits', score: 3 },
                                    { text: 'Advanced security with automated compliance monitoring', score: 4 },
                                    { text: 'Zero-trust architecture with continuous compliance validation', score: 5 }
                                ]
                            },
                            {
                                id: 'cloud_sc2',
                                text: 'What percentage of your security controls are cloud-native and automated?',
                                type: 'adoption',
                                weight: 4,
                                options: [
                                    { text: 'Less than 25% - Mostly manual security processes', score: 15 },
                                    { text: '25-50% - Basic automation with manual oversight', score: 35 },
                                    { text: '50-75% - Good automation across most security domains', score: 65 },
                                    { text: '75-90% - Comprehensive automated security controls', score: 85 },
                                    { text: 'Over 90% - Fully automated cloud-native security', score: 95 }
                                ]
                            },
                            {
                                id: 'cloud_sc3',
                                text: 'How comprehensive is your data protection and privacy compliance in cloud environments?',
                                type: 'evidence',
                                weight: 5,
                                options: [
                                    { text: 'Basic compliance - Limited data protection controls', score: 10 },
                                    { text: 'Standard compliance - Meets basic regulatory requirements', score: 30 },
                                    { text: 'Good compliance - Comprehensive data protection strategy', score: 60 },
                                    { text: 'Advanced compliance - Proactive privacy-by-design approach', score: 85 },
                                    { text: 'Industry-leading compliance - Zero-trust data protection', score: 95 }
                                ]
                            }
                        ]
                    },
                    {
                        name: 'Application Architecture',
                        weight: 4,
                        requiredScore: 75,
                        questions: [
                            {
                                id: 'cloud_aa1',
                                text: 'What percentage of your applications are cloud-ready or cloud-native?',
                                type: 'adoption',
                                weight: 5,
                                options: [
                                    { text: 'Less than 25% - Mostly legacy applications', score: 15 },
                                    { text: '25-50% - Some modernization completed', score: 35 },
                                    { text: '50-75% - Significant progress on cloud readiness', score: 65 },
                                    { text: '75-90% - Most applications are cloud-optimized', score: 85 },
                                    { text: 'Over 90% - Primarily cloud-native architecture', score: 95 }
                                ]
                            },
                            {
                                id: 'cloud_aa2',
                                text: 'How mature is your microservices and containerization strategy?',
                                type: 'maturity',
                                weight: 4,
                                options: [
                                    { text: 'Monolithic applications with limited containerization', score: 1 },
                                    { text: 'Basic containerization with simple orchestration', score: 2 },
                                    { text: 'Microservices adoption with Kubernetes deployment', score: 3 },
                                    { text: 'Advanced container orchestration with service mesh', score: 4 },
                                    { text: 'Cloud-native platform with automated scaling and management', score: 5 }
                                ]
                            },
                            {
                                id: 'cloud_aa3',
                                text: 'How effective is your application performance monitoring in cloud environments?',
                                type: 'evidence',
                                weight: 3,
                                options: [
                                    { text: 'Basic monitoring - Limited visibility into application performance', score: 10 },
                                    { text: 'Standard monitoring - Basic metrics and alerting', score: 30 },
                                    { text: 'Good monitoring - Comprehensive metrics across applications', score: 60 },
                                    { text: 'Advanced monitoring - Real-time analytics with AI insights', score: 85 },
                                    { text: 'Intelligent monitoring - Predictive analytics and auto-remediation', score: 95 }
                                ]
                            }
                        ]
                    },
                    {
                        name: 'Network & Infrastructure',
                        weight: 4,
                        requiredScore: 70,
                        questions: [
                            {
                                id: 'cloud_ni1',
                                text: 'How robust is your network connectivity and bandwidth for cloud operations?',
                                type: 'evidence',
                                weight: 4,
                                options: [
                                    { text: 'Limited bandwidth - Significant latency and performance issues', score: 10 },
                                    { text: 'Basic connectivity - Adequate for current needs', score: 30 },
                                    { text: 'Good connectivity - Reliable with some redundancy', score: 60 },
                                    { text: 'Excellent connectivity - High-speed with full redundancy', score: 85 },
                                    { text: 'Premium connectivity - Multiple high-speed connections with edge optimization', score: 95 }
                                ]
                            },
                            {
                                id: 'cloud_ni2',
                                text: 'What is your disaster recovery and business continuity maturity for cloud workloads?',
                                type: 'maturity',
                                weight: 5,
                                options: [
                                    { text: 'Basic backup with manual recovery processes', score: 1 },
                                    { text: 'Standard DR with documented recovery procedures', score: 2 },
                                    { text: 'Automated DR with regular testing and validation', score: 3 },
                                    { text: 'Advanced DR with multi-region failover capabilities', score: 4 },
                                    { text: 'Continuous availability with zero-downtime recovery', score: 5 }
                                ]
                            }
                        ]
                    },
                    {
                        name: 'Migration Strategy & Planning',
                        weight: 5,
                        requiredScore: 80,
                        questions: [
                            {
                                id: 'cloud_ms1',
                                text: 'How comprehensive is your cloud migration assessment and planning process?',
                                type: 'evidence',
                                weight: 5,
                                options: [
                                    { text: 'Limited assessment - Basic inventory with minimal planning', score: 10 },
                                    { text: 'Standard assessment - Application inventory with migration priorities', score: 30 },
                                    { text: 'Comprehensive assessment - Detailed technical and business analysis', score: 60 },
                                    { text: 'Advanced assessment - Automated discovery with cost optimization', score: 85 },
                                    { text: 'Strategic assessment - AI-powered migration planning with risk analysis', score: 95 }
                                ]
                            },
                            {
                                id: 'cloud_ms2',
                                text: 'What percentage of your migration strategy includes application modernization vs lift-and-shift?',
                                type: 'adoption',
                                weight: 4,
                                options: [
                                    { text: 'Mostly lift-and-shift - Limited modernization plans', score: 15 },
                                    { text: '25% modernization - Some refactoring for cloud benefits', score: 35 },
                                    { text: '50% modernization - Balanced approach to migration', score: 65 },
                                    { text: '75% modernization - Significant cloud-native transformation', score: 85 },
                                    { text: 'Modernization-first - Cloud-native rebuilding for most applications', score: 95 }
                                ]
                            }
                        ]
                    },
                    {
                        name: 'Skills & Team Readiness',
                        weight: 3,
                        requiredScore: 65,
                        questions: [
                            {
                                id: 'cloud_st1',
                                text: 'How would you rate your team\'s cloud expertise and certification levels?',
                                type: 'adoption',
                                weight: 4,
                                options: [
                                    { text: 'Limited cloud knowledge - Significant training required', score: 15 },
                                    { text: 'Basic cloud skills - Some team members with certifications', score: 35 },
                                    { text: 'Good cloud expertise - Most team members are cloud-trained', score: 65 },
                                    { text: 'Strong cloud skills - Advanced certifications across team', score: 85 },
                                    { text: 'Cloud experts - Industry-recognized expertise and thought leadership', score: 95 }
                                ]
                            },
                            {
                                id: 'cloud_st2',
                                text: 'How effective is your organization at managing distributed cloud teams and operations?',
                                type: 'maturity',
                                weight: 3,
                                options: [
                                    { text: 'Traditional centralized model - Limited distributed capabilities', score: 1 },
                                    { text: 'Basic distributed operations - Some remote management', score: 2 },
                                    { text: 'Good distributed model - Effective remote team coordination', score: 3 },
                                    { text: 'Advanced distributed operations - Seamless global team management', score: 4 },
                                    { text: 'Cloud-native organization - Fully distributed with automated operations', score: 5 }
                                ]
                            }
                        ]
                    }
                ]
            },
            'customer-experience': {
                id: 'customer-experience',
                name: 'Digital Customer Experience Platform',
                icon: 'fas fa-users',
                description: 'Transform customer interactions through digital channels, personalization, and omnichannel experience optimization.',
                category: 'Customer-Centric',
                complexity: 'Medium',
                complexityColor: 'complexity-medium',
                typicalROI: '150-300%',
                timeframe: '6-12 months',
                industryExamples: {
                    retail: 'Omnichannel platform increasing customer lifetime value by 45%',
                    financial: 'Digital banking experience reducing service costs by 60%',
                    healthcare: 'Patient portal improving satisfaction scores by 35%',
                    manufacturing: 'B2B customer portal reducing order processing time by 50%'
                },
                capabilities: [
                    {
                        name: 'Customer Data Integration',
                        weight: 5,
                        requiredScore: 80,
                        questions: [
                            {
                                id: 'cx_cdi1',
                                text: 'How well integrated is your customer data across all touchpoints?',
                                type: 'adoption',
                                weight: 5,
                                options: [
                                    { text: 'Siloed data - Each channel maintains separate records', score: 15 },
                                    { text: 'Basic integration - Some data sharing between systems', score: 35 },
                                    { text: 'Good integration - Most customer data is unified', score: 65 },
                                    { text: 'Strong integration - Real-time customer data synchronization', score: 85 },
                                    { text: 'Complete integration - 360-degree customer view', score: 95 }
                                ]
                            },
                            {
                                id: 'cx_cdi2',
                                text: 'How mature is your customer analytics and segmentation capability?',
                                type: 'maturity',
                                weight: 4,
                                options: [
                                    { text: 'Basic demographics - Limited segmentation capability', score: 1 },
                                    { text: 'Standard segmentation - Demographic and behavioral analysis', score: 2 },
                                    { text: 'Advanced analytics - Predictive modeling and lifecycle analysis', score: 3 },
                                    { text: 'AI-powered insights - Real-time personalization and recommendations', score: 4 },
                                    { text: 'Intelligent customer platform - Predictive and prescriptive analytics', score: 5 }
                                ]
                            },
                            {
                                id: 'cx_cdi3',
                                text: 'What percentage of customer interactions are tracked and analyzed for insights?',
                                type: 'adoption',
                                weight: 4,
                                options: [
                                    { text: 'Less than 30% - Limited interaction tracking', score: 15 },
                                    { text: '30-50% - Basic tracking across major touchpoints', score: 35 },
                                    { text: '50-75% - Good coverage of customer interactions', score: 65 },
                                    { text: '75-90% - Comprehensive tracking across channels', score: 85 },
                                    { text: 'Over 90% - Complete customer journey visibility', score: 95 }
                                ]
                            }
                        ]
                    },
                    {
                        name: 'Digital Channel Strategy',
                        weight: 4,
                        requiredScore: 75,
                        questions: [
                            {
                                id: 'cx_dcs1',
                                text: 'How comprehensive is your omnichannel customer experience strategy?',
                                type: 'evidence',
                                weight: 5,
                                options: [
                                    { text: 'Single channel focus - Limited cross-channel coordination', score: 10 },
                                    { text: 'Multi-channel presence - Some channel coordination', score: 30 },
                                    { text: 'Omnichannel approach - Good coordination across channels', score: 60 },
                                    { text: 'Integrated experience - Seamless cross-channel journeys', score: 85 },
                                    { text: 'Unified platform - Single view driving all customer interactions', score: 95 }
                                ]
                            },
                            {
                                id: 'cx_dcs2',
                                text: 'How mature is your mobile-first customer experience design?',
                                type: 'maturity',
                                weight: 4,
                                options: [
                                    { text: 'Desktop-focused - Basic mobile responsive design', score: 1 },
                                    { text: 'Mobile-responsive - Good mobile experience', score: 2 },
                                    { text: 'Mobile-optimized - Dedicated mobile experience design', score: 3 },
                                    { text: 'Mobile-first - Leading with mobile experience design', score: 4 },
                                    { text: 'Mobile-native - AI-powered personalized mobile experiences', score: 5 }
                                ]
                            },
                            {
                                id: 'cx_dcs3',
                                text: 'What is your capability for real-time personalization across digital touchpoints?',
                                type: 'evidence',
                                weight: 4,
                                options: [
                                    { text: 'Static content - No personalization capability', score: 10 },
                                    { text: 'Basic personalization - Simple rules-based content', score: 30 },
                                    { text: 'Dynamic personalization - Behavior-driven content adaptation', score: 60 },
                                    { text: 'AI-powered personalization - Real-time content optimization', score: 85 },
                                    { text: 'Intelligent personalization - Predictive and contextual experiences', score: 95 }
                                ]
                            }
                        ]
                    },
                    {
                        name: 'Customer Service Technology',
                        weight: 4,
                        requiredScore: 70,
                        questions: [
                            {
                                id: 'cx_cst1',
                                text: 'How advanced is your customer service automation and AI implementation?',
                                type: 'adoption',
                                weight: 4,
                                options: [
                                    { text: 'Manual service - No automation or AI', score: 15 },
                                    { text: 'Basic automation - Simple chatbots and FAQ systems', score: 35 },
                                    { text: 'Moderate automation - Intelligent routing and basic AI', score: 65 },
                                    { text: 'Advanced automation - Sophisticated AI with natural language processing', score: 85 },
                                    { text: 'Intelligent service - Proactive AI-driven customer support', score: 95 }
                                ]
                            },
                            {
                                id: 'cx_cst2',
                                text: 'How comprehensive is your self-service customer portal and knowledge base?',
                                type: 'evidence',
                                weight: 3,
                                options: [
                                    { text: 'Limited self-service - Basic FAQ and contact forms', score: 10 },
                                    { text: 'Standard portal - Account management and basic resources', score: 30 },
                                    { text: 'Comprehensive portal - Full self-service capabilities', score: 60 },
                                    { text: 'Advanced portal - AI-powered assistance and recommendations', score: 85 },
                                    { text: 'Intelligent platform - Proactive support with predictive assistance', score: 95 }
                                ]
                            }
                        ]
                    },
                    {
                        name: 'Experience Measurement & Optimization',
                        weight: 3,
                        requiredScore: 65,
                        questions: [
                            {
                                id: 'cx_emo1',
                                text: 'How mature is your customer experience measurement and feedback system?',
                                type: 'maturity',
                                weight: 4,
                                options: [
                                    { text: 'Basic surveys - Annual or semi-annual feedback collection', score: 1 },
                                    { text: 'Regular surveys - Quarterly feedback with basic analytics', score: 2 },
                                    { text: 'Continuous feedback - Multiple touchpoint measurement', score: 3 },
                                    { text: 'Real-time insights - Automated feedback collection and analysis', score: 4 },
                                    { text: 'Intelligent measurement - AI-powered sentiment and experience analytics', score: 5 }
                                ]
                            },
                            {
                                id: 'cx_emo2',
                                text: 'How effectively do you use customer experience data to drive business decisions?',
                                type: 'evidence',
                                weight: 4,
                                options: [
                                    { text: 'Limited usage - Data collected but not systematically used', score: 10 },
                                    { text: 'Basic usage - Some influence on product and service decisions', score: 30 },
                                    { text: 'Good usage - Regular integration into business planning', score: 60 },
                                    { text: 'Strategic usage - CX data drives major business initiatives', score: 85 },
                                    { text: 'Intelligent usage - Real-time CX data drives automated optimizations', score: 95 }
                                ]
                            }
                        ]
                    }
                ]
            },
            'data-analytics': {
                id: 'data-analytics',
                name: 'Advanced Analytics & Business Intelligence',
                icon: 'fas fa-chart-bar',
                description: 'Build enterprise data platform with advanced analytics, business intelligence, and self-service reporting capabilities.',
                category: 'Data & Insights',
                complexity: 'Medium-High',
                complexityColor: 'complexity-medium',
                typicalROI: '250-450%',
                timeframe: '9-18 months',
                industryExamples: {
                    manufacturing: 'Predictive analytics optimizing production efficiency by 25%',
                    retail: 'Customer analytics increasing marketing ROI by 180%',
                    financial: 'Risk analytics reducing loan defaults by 40%',
                    healthcare: 'Population health analytics improving outcomes by 30%'
                },
                capabilities: [
                    {
                        name: 'Data Infrastructure',
                        weight: 5,
                        requiredScore: 75,
                        questions: [
                            {
                                id: 'da_di1',
                                text: 'How robust and scalable is your data infrastructure?',
                                type: 'maturity',
                                weight: 5,
                                options: [
                                    { text: 'Basic data storage with manual processes', score: 1 },
                                    { text: 'Structured data warehouse with some automation', score: 2 },
                                    { text: 'Modern data lake with integrated processing', score: 3 },
                                    { text: 'Cloud-native analytics platform with real-time capabilities', score: 4 },
                                    { text: 'Advanced streaming analytics with AI-powered insights', score: 5 }
                                ]
                            },
                            {
                                id: 'da_di2',
                                text: 'What percentage of your enterprise data is accessible for analytics?',
                                type: 'adoption',
                                weight: 5,
                                options: [
                                    { text: 'Less than 30% - Most data in isolated systems', score: 15 },
                                    { text: '30-50% - Basic data integration completed', score: 35 },
                                    { text: '50-75% - Good progress on data accessibility', score: 65 },
                                    { text: '75-90% - Comprehensive data integration', score: 85 },
                                    { text: 'Over 90% - Complete enterprise data accessibility', score: 95 }
                                ]
                            },
                            {
                                id: 'da_di3',
                                text: 'How mature is your data quality and governance framework?',
                                type: 'evidence',
                                weight: 4,
                                options: [
                                    { text: 'Limited governance - Ad-hoc data quality processes', score: 10 },
                                    { text: 'Basic governance - Standard data quality checks', score: 30 },
                                    { text: 'Good governance - Comprehensive data quality framework', score: 60 },
                                    { text: 'Advanced governance - Automated quality monitoring and remediation', score: 85 },
                                    { text: 'Intelligent governance - AI-powered data quality and lineage', score: 95 }
                                ]
                            }
                        ]
                    },
                    {
                        name: 'Analytics Capabilities',
                        weight: 5,
                        requiredScore: 70,
                        questions: [
                            {
                                id: 'da_ac1',
                                text: 'What is the maturity of your advanced analytics and machine learning capabilities?',
                                type: 'maturity',
                                weight: 5,
                                options: [
                                    { text: 'Basic reporting - Descriptive analytics only', score: 1 },
                                    { text: 'Standard analytics - Some diagnostic and trending analysis', score: 2 },
                                    { text: 'Advanced analytics - Predictive modeling and statistical analysis', score: 3 },
                                    { text: 'Machine learning - Automated model building and deployment', score: 4 },
                                    { text: 'AI-powered analytics - Autonomous insights and recommendations', score: 5 }
                                ]
                            },
                            {
                                id: 'da_ac2',
                                text: 'How comprehensive is your self-service analytics adoption across the organization?',
                                type: 'adoption',
                                weight: 4,
                                options: [
                                    { text: 'IT-dependent - All analytics requires technical support', score: 15 },
                                    { text: 'Limited self-service - Basic reporting for power users', score: 35 },
                                    { text: 'Moderate self-service - Business users can create reports', score: 65 },
                                    { text: 'Comprehensive self-service - Advanced analytics for business users', score: 85 },
                                    { text: 'Fully democratized - Organization-wide self-service analytics', score: 95 }
                                ]
                            },
                            {
                                id: 'da_ac3',
                                text: 'How effectively do you deliver real-time analytics and streaming insights?',
                                type: 'evidence',
                                weight: 4,
                                options: [
                                    { text: 'Batch processing - Daily or weekly data updates', score: 10 },
                                    { text: 'Near real-time - Hourly data processing', score: 30 },
                                    { text: 'Real-time dashboards - Continuous data updates', score: 60 },
                                    { text: 'Streaming analytics - Real-time processing and alerts', score: 85 },
                                    { text: 'Intelligent streaming - AI-powered real-time insights and actions', score: 95 }
                                ]
                            }
                        ]
                    },
                    {
                        name: 'Business Intelligence & Reporting',
                        weight: 4,
                        requiredScore: 65,
                        questions: [
                            {
                                id: 'da_bir1',
                                text: 'How comprehensive is your enterprise reporting and dashboard strategy?',
                                type: 'evidence',
                                weight: 4,
                                options: [
                                    { text: 'Ad-hoc reporting - No standardized dashboard strategy', score: 10 },
                                    { text: 'Basic dashboards - Standard operational reports', score: 30 },
                                    { text: 'Comprehensive BI - Executive and operational dashboards', score: 60 },
                                    { text: 'Advanced BI - Interactive analytics with drill-down capabilities', score: 85 },
                                    { text: 'Intelligent BI - AI-powered insights and automated reporting', score: 95 }
                                ]
                            },
                            {
                                id: 'da_bir2',
                                text: 'What percentage of business decisions are supported by data analytics?',
                                type: 'adoption',
                                weight: 4,
                                options: [
                                    { text: 'Less than 30% - Mostly intuition-based decisions', score: 15 },
                                    { text: '30-50% - Some data influence on major decisions', score: 35 },
                                    { text: '50-75% - Data regularly informs business decisions', score: 65 },
                                    { text: '75-90% - Data-driven decision making culture', score: 85 },
                                    { text: 'Over 90% - Complete data-driven organization', score: 95 }
                                ]
                            }
                        ]
                    },
                    {
                        name: 'Data Science & Advanced Analytics Team',
                        weight: 3,
                        requiredScore: 60,
                        questions: [
                            {
                                id: 'da_ds1',
                                text: 'How mature is your data science team and analytical capabilities?',
                                type: 'maturity',
                                weight: 4,
                                options: [
                                    { text: 'No dedicated data science team', score: 1 },
                                    { text: 'Small team with basic statistical analysis skills', score: 2 },
                                    { text: 'Experienced team with advanced modeling capabilities', score: 3 },
                                    { text: 'Strong team with machine learning and AI expertise', score: 4 },
                                    { text: 'World-class team with cutting-edge research and development', score: 5 }
                                ]
                            },
                            {
                                id: 'da_ds2',
                                text: 'How effectively do your data scientists collaborate with business stakeholders?',
                                type: 'evidence',
                                weight: 3,
                                options: [
                                    { text: 'Limited collaboration - Technical team works in isolation', score: 10 },
                                    { text: 'Basic collaboration - Periodic meetings and updates', score: 30 },
                                    { text: 'Good collaboration - Regular partnership on projects', score: 60 },
                                    { text: 'Strong collaboration - Embedded business partnership model', score: 85 },
                                    { text: 'Seamless collaboration - Integrated business-technical teams', score: 95 }
                                ]
                            }
                        ]
                    }
                ]
            }
        };

        // Admin Functions
        function toggleAdminMode() {
            appState.adminMode = !appState.adminMode;
            const adminNav = document.getElementById('admin-nav');
            const adminToggle = document.getElementById('admin-toggle');
            
            if (appState.adminMode) {
                adminNav.style.display = 'block';
                adminToggle.innerHTML = '<i class="fas fa-user"></i> User Mode';
                adminToggle.className = 'btn btn-danger';
                showSection('admin');
            } else {
                adminNav.style.display = 'none';
                adminToggle.innerHTML = '<i class="fas fa-cog"></i> Admin Mode';
                adminToggle.className = 'btn btn-secondary';
                showSection('dashboard');
            }
        }

        function showAdminTab(tabId) {
            // Update tab navigation
            document.querySelectorAll('.admin-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.admin-content').forEach(content => content.classList.remove('active'));
            
            document.querySelector(`[onclick="showAdminTab('${tabId}')"]`).classList.add('active');
            document.getElementById(`admin-${tabId}`).classList.add('active');
            
            appState.currentAdminTab = tabId;
            
            // Initialize tab-specific content
            if (tabId === 'questionnaires') {
                initializeQuestionnaireAdmin();
            } else if (tabId === 'initiatives') {
                initializeInitiativeAdmin();
            }
        }

        function initializeQuestionnaireAdmin() {
            populateAdminDropdowns();
            updateQuestionnaireOverview();
            updateContentStats();
            updateQuestionTypeOptions();
            refreshQuestionList();
        }

        function populateAdminDropdowns() {
            const initiativeSelect = document.getElementById('admin-initiative');
            const filterSelect = document.getElementById('filter-initiative');
            
            // Clear existing options
            initiativeSelect.innerHTML = '<option value="">Select Initiative</option>';
            filterSelect.innerHTML = '<option value="">All Initiatives</option>';
            
            // Populate with current initiatives
            Object.values(initiatives).forEach(initiative => {
                const option = `<option value="${initiative.id}">${initiative.name}</option>`;
                initiativeSelect.innerHTML += option;
                filterSelect.innerHTML += option;
            });
            
            // Set up capability dropdown population
            initiativeSelect.onchange = function() {
                const capabilitySelect = document.getElementById('admin-capability');
                capabilitySelect.innerHTML = '<option value="">Select Capability</option>';
                capabilitySelect.disabled = !this.value;
                
                if (this.value && initiatives[this.value]) {
                    initiatives[this.value].capabilities.forEach(capability => {
                        capabilitySelect.innerHTML += `<option value="${capability.name}">${capability.name}</option>`;
                    });
                }
            };
        }

        function updateQuestionTypeOptions() {
            const typeSelect = document.getElementById('admin-type');
            const optionsContainer = document.getElementById('admin-options');
            
            function refreshOptions() {
                const questionType = typeSelect.value;
                optionsContainer.innerHTML = '';
                
                let defaultOptions = [];
                
                if (questionType === 'evidence') {
                    defaultOptions = [
                        { text: 'No evidence available or implemented', score: 10 },
                        { text: 'Limited evidence with basic implementation', score: 30 },
                        { text: 'Some evidence with moderate implementation', score: 50 },
                        { text: 'Strong evidence with comprehensive implementation', score: 75 },
                        { text: 'Comprehensive evidence with industry-leading implementation', score: 95 }
                    ];
                } else if (questionType === 'adoption') {
                    defaultOptions = [
                        { text: 'Less than 20% - Minimal adoption across organization', score: 15 },
                        { text: '20-40% - Basic adoption in key areas', score: 35 },
                        { text: '40-70% - Moderate adoption across most areas', score: 60 },
                        { text: '70-90% - Extensive adoption organization-wide', score: 85 },
                        { text: 'Over 90% - Comprehensive adoption with optimization', score: 95 }
                    ];
                } else { // maturity
                    defaultOptions = [
                        { text: 'Initial/Ad-hoc - Unpredictable processes and outcomes', score: 1 },
                        { text: 'Managed/Repeatable - Basic processes with some consistency', score: 2 },
                        { text: 'Defined/Standardized - Documented processes organization-wide', score: 3 },
                        { text: 'Quantitatively Managed - Data-driven process management', score: 4 },
                        { text: 'Optimizing/Continuous Improvement - Self-improving processes', score: 5 }
                    ];
                }
                
                defaultOptions.forEach((option, index) => {
                    const optionDiv = document.createElement('div');
                    optionDiv.style.cssText = 'display: flex; gap: 12px; margin-bottom: 12px; align-items: center;';
                    optionDiv.innerHTML = `
                        <span style="min-width: 60px; font-weight: 600;">Option ${index + 1}:</span>
                        <input type="text" value="${option.text}" id="option-text-${index}" 
                               style="flex: 1; padding: 8px; border: 2px solid var(--border-gray); border-radius: 6px;">
                        <input type="number" value="${option.score}" id="option-score-${index}" 
                               style="width: 80px; padding: 8px; border: 2px solid var(--border-gray); border-radius: 6px;"
                               min="0" max="100">
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
            }
            
            typeSelect.onchange = refreshOptions;
            refreshOptions(); // Initialize with default
        }

        function updateQuestionnaireOverview() {
            const container = document.getElementById('questionnaire-summary');
            container.innerHTML = '';
            
            Object.values(initiatives).forEach(initiative => {
                let totalQuestions = 0;
                let totalCapabilities = initiative.capabilities.length;
                
                initiative.capabilities.forEach(capability => {
                    if (capability.questions) {
                        totalQuestions += capability.questions.length;
                    }
                });
                
                const completeness = totalQuestions > 0 ? 'Complete' : 'Incomplete';
                const statusColor = totalQuestions > 0 ? 'var(--success-green)' : 'var(--warning-amber)';
                
                container.innerHTML += `
                    <div style="padding: 12px; background: var(--background-gray); border-radius: 8px; margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <strong>${initiative.name}</strong><br>
                            <small style="color: var(--neutral-gray-light);">${totalCapabilities} capabilities, ${totalQuestions} questions</small>
                        </div>
                        <span style="color: ${statusColor}; font-weight: 600; font-size: 12px;">${completeness}</span>
                    </div>
                `;
            });
        }

        function updateContentStats() {
            let totalQuestions = 0;
            let totalCapabilities = 0;
            
            Object.values(initiatives).forEach(initiative => {
                totalCapabilities += initiative.capabilities.length;
                initiative.capabilities.forEach(capability => {
                    if (capability.questions) {
                        totalQuestions += capability.questions.length;
                    }
                });
            });
            
            document.getElementById('total-questions').textContent = totalQuestions;
            document.getElementById('total-capabilities').textContent = totalCapabilities;
        }

        function saveQuestion() {
            const initiativeId = document.getElementById('admin-initiative').value;
            const capabilityName = document.getElementById('admin-capability').value;
            const questionText = document.getElementById('admin-question').value.trim();
            const questionType = document.getElementById('admin-type').value;
            const questionWeight = parseInt(document.getElementById('admin-weight').value);
            
            if (!initiativeId || !capabilityName || !questionText) {
                alert('Please fill in all required fields: Initiative, Capability, and Question Text.');
                return;
            }
            
            // Collect options
            const options = [];
            for (let i = 0; i < 5; i++) {
                const textInput = document.getElementById(`option-text-${i}`);
                const scoreInput = document.getElementById(`option-score-${i}`);
                if (textInput && scoreInput) {
                    options.push({
                        text: textInput.value.trim(),
                        score: parseInt(scoreInput.value)
                    });
                }
            }
            
            if (options.length !== 5) {
                alert('Please ensure all 5 answer options are properly filled out.');
                return;
            }
            
            // Find the capability and add the question
            const initiative = initiatives[initiativeId];
            const capability = initiative.capabilities.find(cap => cap.name === capabilityName);
            
            if (capability) {
                if (!capability.questions) capability.questions = [];
                
                // Generate unique question ID
                const questionId = `${initiativeId}_${capabilityName.toLowerCase().replace(/[^a-z]/g, '')}_${capability.questions.length + 1}`;
                
                const newQuestion = {
                    id: questionId,
                    text: questionText,
                    type: questionType,
                    weight: questionWeight,
                    options: options
                };
                
                capability.questions.push(newQuestion);
                
                // Show success message
                showSuccessMessage('Question added successfully!');
                
                // Reset form and refresh displays
                resetQuestionForm();
                updateQuestionnaireOverview();
                updateContentStats();
                refreshQuestionList();
            } else {
                alert('Error: Could not find the selected capability.');
            }
        }

        function resetQuestionForm() {
            document.getElementById('admin-initiative').value = '';
            document.getElementById('admin-capability').innerHTML = '<option value="">Select Capability</option>';
            document.getElementById('admin-capability').disabled = true;
            document.getElementById('admin-question').value = '';
            document.getElementById('admin-type').value = 'evidence';
            document.getElementById('admin-weight').value = '3';
            updateQuestionTypeOptions();
        }

        function previewQuestion() {
            const questionText = document.getElementById('admin-question').value.trim();
            const questionType = document.getElementById('admin-type').value;
            
            if (!questionText) {
                alert('Please enter question text to preview.');
                return;
            }
            
            // Collect options for preview
            const options = [];
            for (let i = 0; i < 5; i++) {
                const textInput = document.getElementById(`option-text-${i}`);
                const scoreInput = document.getElementById(`option-score-${i}`);
                if (textInput && scoreInput) {
                    options.push({
                        text: textInput.value.trim(),
                        score: parseInt(scoreInput.value)
                    });
                }
            }
            
            // Create preview modal
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
                background: rgba(0,0,0,0.5); z-index: 10000; display: flex; 
                align-items: center; justify-content: center;
            `;
            
            modal.innerHTML = `
                <div style="background: white; padding: 32px; border-radius: 12px; max-width: 600px; width: 90%;">
                    <h3 style="margin-bottom: 20px; color: var(--primary-blue);">
                        <i class="fas fa-eye"></i> Question Preview
                    </h3>
                    <div class="question-card">
                        <div class="question-header">
                            <div class="question-number">1</div>
                            <div class="question-text">${questionText}</div>
                        </div>
                        <div class="question-options">
                            ${options.map(option => `
                                <div class="option-button">
                                    <span class="option-text">${option.text}</span>
                                    <span class="option-score">${option.score}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    <div style="text-align: center; margin-top: 24px;">
                        <button class="btn btn-primary" onclick="this.closest('div[style*=\"fixed\"]').remove()">
                            <i class="fas fa-times"></i> Close Preview
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            modal.onclick = (e) => {
                if (e.target === modal) modal.remove();
            };
        }

        function refreshQuestionList() {
            const container = document.getElementById('question-management-list');
            const filterInitiative = document.getElementById('filter-initiative').value;
            container.innerHTML = '';
            
            Object.values(initiatives).forEach(initiative => {
                if (filterInitiative && initiative.id !== filterInitiative) return;
                
                initiative.capabilities.forEach(capability => {
                    if (capability.questions && capability.questions.length > 0) {
                        capability.questions.forEach((question, index) => {
                            const questionDiv = document.createElement('div');
                            questionDiv.className = 'card mb-4';
                            questionDiv.innerHTML = `
                                <div class="card-content">
                                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                                        <div style="flex: 1;">
                                            <h5 style="margin-bottom: 4px; color: var(--primary-blue);">
                                                ${initiative.name} → ${capability.name}
                                            </h5>
                                            <p style="margin-bottom: 8px; color: var(--neutral-gray);">${question.text}</p>
                                            <div style="display: flex; gap: 16px; font-size: 12px; color: var(--neutral-gray-light);">
                                                <span><strong>Type:</strong> ${question.type}</span>
                                                <span><strong>Weight:</strong> ${question.weight || 3}/5</span>
                                                <span><strong>Options:</strong> ${question.options.length}</span>
                                            </div>
                                        </div>
                                        <div style="display: flex; gap: 8px;">
                                            <button class="btn btn-secondary" onclick="editQuestion('${initiative.id}', '${capability.name}', ${index})" style="padding: 6px 12px; font-size: 12px;">
                                                <i class="fas fa-edit"></i> Edit
                                            </button>
                                            <button class="btn btn-danger" onclick="deleteQuestion('${initiative.id}', '${capability.name}', ${index})" style="padding: 6px 12px; font-size: 12px;">
                                                <i class="fas fa-trash"></i> Delete
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            `;
                            container.appendChild(questionDiv);
                        });
                    }
                });
            });
            
            if (container.innerHTML === '') {
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: var(--neutral-gray-light);">
                        <i class="fas fa-clipboard-list" style="font-size: 48px; margin-bottom: 16px;"></i>
                        <h4>No Questions Found</h4>
                        <p>Add questions using the form above or adjust the filter criteria.</p>
                    </div>
                `;
            }
        }

        function deleteQuestion(initiativeId, capabilityName, questionIndex) {
            if (!confirm('Are you sure you want to delete this question? This action cannot be undone.')) {
                return;
            }
            
            const initiative = initiatives[initiativeId];
            const capability = initiative.capabilities.find(cap => cap.name === capabilityName);
            
            if (capability && capability.questions) {
                capability.questions.splice(questionIndex, 1);
                showSuccessMessage('Question deleted successfully!');
                refreshQuestionList();
                updateQuestionnaireOverview();
                updateContentStats();
            }
        }

        function editQuestion(initiativeId, capabilityName, questionIndex) {
            const initiative = initiatives[initiativeId];
            const capability = initiative.capabilities.find(cap => cap.name === capabilityName);
            const question = capability.questions[questionIndex];
            
            // Populate form with existing question data
            document.getElementById('admin-initiative').value = initiativeId;
            document.getElementById('admin-initiative').onchange(); // Trigger capability population
            
            setTimeout(() => {
                document.getElementById('admin-capability').value = capabilityName;
                document.getElementById('admin-question').value = question.text;
                document.getElementById('admin-type').value = question.type;
                document.getElementById('admin-weight').value = question.weight || 3;
                
                updateQuestionTypeOptions();
                
                setTimeout(() => {
                    // Populate options
                    question.options.forEach((option, index) => {
                        const textInput = document.getElementById(`option-text-${index}`);
                        const scoreInput = document.getElementById(`option-score-${index}`);
                        if (textInput && scoreInput) {
                            textInput.value = option.text;
                            scoreInput.value = option.score;
                        }
                    });
                }, 100);
            }, 100);
            
            // Delete the old question (it will be re-added when saved)
            capability.questions.splice(questionIndex, 1);
            
            // Scroll to form
            document.getElementById('admin-question').scrollIntoView({ behavior: 'smooth' });
            showSuccessMessage('Question loaded for editing. Make changes and click Save.');
        }

        function initializeInitiativeAdmin() {
            updateInitiativeOverview();
        }

        function updateInitiativeOverview() {
            const container = document.getElementById('initiative-overview');
            container.innerHTML = '';
            
            Object.values(initiatives).forEach(initiative => {
                let questionCount = 0;
                initiative.capabilities.forEach(cap => {
                    if (cap.questions) questionCount += cap.questions.length;
                });
                
                container.innerHTML += `
                    <div style="padding: 12px; background: var(--background-gray); border-radius: 8px; margin-bottom: 8px;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <strong style="color: var(--primary-blue);">${initiative.name}</strong><br>
                                <small style="color: var(--neutral-gray-light);">
                                    ${initiative.capabilities.length} capabilities • ${questionCount} questions • ${initiative.complexity} complexity
                                </small>
                            </div>
                            <button class="btn btn-danger" onclick="deleteInitiative('${initiative.id}')" style="padding: 4px 8px; font-size: 11px;">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `;
            });
        }

        function createInitiative() {
            const id = document.getElementById('new-initiative-id').value.trim();
            const name = document.getElementById('new-initiative-name').value.trim();
            const icon = document.getElementById('new-initiative-icon').value.trim();
            const description = document.getElementById('new-initiative-description').value.trim();
            const complexity = document.getElementById('new-initiative-complexity').value;
            const category = document.getElementById('new-initiative-category').value.trim();
            const roi = document.getElementById('new-initiative-roi').value.trim();
            const timeframe = document.getElementById('new-initiative-timeframe').value.trim();
            
            if (!id || !name || !description) {
                alert('Please fill in all required fields: ID, Name, and Description.');
                return;
            }
            
            if (initiatives[id]) {
                alert('An initiative with this ID already exists. Please use a unique ID.');
                return;
            }
            
            // Create new initiative
            const complexityColorMap = {
                'Low': 'complexity-low',
                'Medium': 'complexity-medium',
                'Medium-High': 'complexity-medium',
                'High': 'complexity-high'
            };
            
            initiatives[id] = {
                id: id,
                name: name,
                icon: icon || 'fas fa-rocket',
                description: description,
                category: category || 'General',
                complexity: complexity,
                complexityColor: complexityColorMap[complexity] || 'complexity-medium',
                typicalROI: roi || 'TBD',
                timeframe: timeframe || 'TBD',
                industryExamples: {
                    general: 'Custom implementation example - results may vary'
                },
                capabilities: []
            };
            
            // Clear form
            document.getElementById('new-initiative-id').value = '';
            document.getElementById('new-initiative-name').value = '';
            document.getElementById('new-initiative-icon').value = 'fas fa-rocket';
            document.getElementById('new-initiative-description').value = '';
            document.getElementById('new-initiative-complexity').value = 'Medium';
            document.getElementById('new-initiative-category').value = '';
            document.getElementById('new-initiative-roi').value = '';
            document.getElementById('new-initiative-timeframe').value = '';
            
            showSuccessMessage('Initiative created successfully!');
            updateInitiativeOverview();
            populateAdminDropdowns();
            
            // Refresh initiative grid if on initiatives section
            if (appState.currentSection === 'initiatives') {
                populateInitiatives();
            }
        }

        function deleteInitiative(initiativeId) {
            if (!confirm(`Are you sure you want to delete the initiative "${initiatives[initiativeId].name}"? This will also delete all associated questions and cannot be undone.`)) {
                return;
            }
            
            delete initiatives[initiativeId];
            showSuccessMessage('Initiative deleted successfully!');
            updateInitiativeOverview();
            populateAdminDropdowns();
            
            // Refresh initiative grid if on initiatives section
            if (appState.currentSection === 'initiatives') {
                populateInitiatives();
            }
        }

        function updateScoringModel() {
            // This would typically save to a backend, for now just show confirmation
            showSuccessMessage('Scoring model updated successfully!');
        }

        function resetScoringModel() {
            document.getElementById('threshold-ready').value = 70;
            document.getElementById('threshold-caution').value = 50;
            document.getElementById('threshold-critical').value = 40;
            document.getElementById('weight-evidence').value = 1.0;
            document.getElementById('weight-adoption').value = 0.9;
            document.getElementById('weight-maturity').value = 20;
            showSuccessMessage('Scoring model reset to defaults!');
        }

        function testScoringModel() {
            alert('Scoring model test feature coming soon. This will allow you to test the current scoring configuration with sample assessment data.');
        }

        function exportPlatformData() {
            const platformData = {
                initiatives: initiatives,
                scoringModel: {
                    thresholds: {
                        ready: parseInt(document.getElementById('threshold-ready').value),
                        caution: parseInt(document.getElementById('threshold-caution').value),
                        critical: parseInt(document.getElementById('threshold-critical').value)
                    },
                    weights: {
                        evidence: parseFloat(document.getElementById('weight-evidence').value),
                        adoption: parseFloat(document.getElementById('weight-adoption').value),
                        maturity: parseFloat(document.getElementById('weight-maturity').value)
                    }
                },
                exportDate: new Date().toISOString(),
                version: '1.0'
            };
            
            const blob = new Blob([JSON.stringify(platformData, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `TransformIQ_Configuration_${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showSuccessMessage('Platform configuration exported successfully!');
        }

        function importPlatformData(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const importedData = JSON.parse(e.target.result);
                    
                    if (!importedData.initiatives || !importedData.version) {
                        throw new Error('Invalid configuration file format');
                    }
                    
                    if (confirm('This will replace all current platform configuration. Are you sure you want to continue?')) {
                        // Import initiatives
                        Object.assign(initiatives, importedData.initiatives);
                        
                        // Import scoring model if available
                        if (importedData.scoringModel) {
                            const thresholds = importedData.scoringModel.thresholds;
                            const weights = importedData.scoringModel.weights;
                            
                            if (thresholds) {
                                document.getElementById('threshold-ready').value = thresholds.ready || 70;
                                document.getElementById('threshold-caution').value = thresholds.caution || 50;
                                document.getElementById('threshold-critical').value = thresholds.critical || 40;
                            }
                            
                            if (weights) {
                                document.getElementById('weight-evidence').value = weights.evidence || 1.0;
                                document.getElementById('weight-adoption').value = weights.adoption || 0.9;
                                document.getElementById('weight-maturity').value = weights.maturity || 20;
                            }
                        }
                        
                        showSuccessMessage('Platform configuration imported successfully!');
                        
                        // Refresh all admin displays
                        if (appState.currentAdminTab === 'questionnaires') {
                            initializeQuestionnaireAdmin();
                        } else if (appState.currentAdminTab === 'initiatives') {
                            initializeInitiativeAdmin();
                        }
                        
                        // Refresh main platform if needed
                        if (appState.currentSection === 'initiatives') {
                            populateInitiatives();
                        }
                    }
                } catch (error) {
                    alert('Error importing configuration: ' + error.message);
                }
            };
            reader.readAsText(file);
        }

        function resetPlatformData() {
            if (!confirm('This will delete ALL custom content and restore the platform to factory defaults. This action cannot be undone. Are you sure?')) {
                return;
            }
            
            if (!confirm('FINAL WARNING: This will permanently delete all questionnaires, custom initiatives, and settings. Type YES in the prompt to confirm.')) {
                return;
            }
            
            const confirmText = prompt('Type "DELETE ALL DATA" to confirm this action:');
            if (confirmText !== 'DELETE ALL DATA') {
                alert('Reset cancelled - confirmation text did not match.');
                return;
            }
            
            // This would restore original initiatives object
            // For demo purposes, just show message
            alert('Platform reset to factory defaults completed. In a real implementation, this would restore the original configuration.');
            location.reload(); // Reload to reset everything
        }

        function showSuccessMessage(message) {
            const alert = document.createElement('div');
            alert.className = 'alert alert-success';
            alert.innerHTML = `
                <i class="fas fa-check-circle"></i>
                <div><strong>Success!</strong> ${message}</div>
            `;
            alert.style.cssText = `
                position: fixed; top: 20px; right: 20px; z-index: 9999; 
                animation: slideIn 0.3s ease-out; max-width: 400px;
            `;
            
            document.body.appendChild(alert);
            
            setTimeout(() => {
                alert.style.animation = 'slideOut 0.3s ease-in forwards';
                setTimeout(() => alert.remove(), 300);
            }, 4000);
        }

        // Application Logic
        function showSection(sectionId) {
            // Update navigation
            document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.page-section').forEach(section => section.classList.remove('active'));
            
            document.querySelector(`[onclick="showSection('${sectionId}')"]`).classList.add('active');
            document.getElementById(sectionId).classList.add('active');
            
            appState.currentSection = sectionId;
            
            // Initialize section-specific content
            if (sectionId === 'initiatives') {
                populateInitiatives();
            } else if (sectionId === 'admin') {
                showAdminTab(appState.currentAdminTab);
            }
        }

        function populateInitiatives() {
            const grid = document.getElementById('initiative-grid');
            grid.innerHTML = '';
            
            Object.values(initiatives).forEach(initiative => {
                // Count questions for this initiative
                let totalQuestions = 0;
                initiative.capabilities.forEach(capability => {
                    if (capability.questions) {
                        totalQuestions += capability.questions.length;
                    }
                });
                
                const card = document.createElement('div');
                card.className = `initiative-card ${appState.selectedInitiative === initiative.id ? 'selected' : ''}`;
                card.onclick = () => selectInitiative(initiative.id);
                
                card.innerHTML = `
                    <div class="initiative-icon">
                        <i class="${initiative.icon}" style="color: var(--primary-blue);"></i>
                    </div>
                    <div class="initiative-name">${initiative.name}</div>
                    <div class="initiative-description">${initiative.description}</div>
                    <div class="initiative-meta">
                        <span class="initiative-complexity ${initiative.complexityColor}">${initiative.complexity}</span>
                        <span class="roi-badge">${initiative.typicalROI}</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 12px; font-size: 12px; color: var(--neutral-gray-light);">
                        <span><i class="fas fa-clock"></i> ${initiative.timeframe}</span>
                        <span><i class="fas fa-layer-group"></i> ${initiative.category}</span>
                    </div>
                    <div style="text-align: center; margin-top: 12px; padding: 8px; background: var(--background-gray); border-radius: 6px;">
                        <span style="font-weight: 600; color: var(--primary-blue);">${totalQuestions} Questions</span>
                        <span style="color: var(--neutral-gray-light); font-size: 11px;"> • Ready for Assessment</span>
                    </div>
                `;
                
                grid.appendChild(card);
            });
        }

        // Quick Assessment Starter from Dashboard
        function startQuickAssessment(initiativeId) {
            // Set the selected initiative
            appState.selectedInitiative = initiativeId;
            
            // Navigate to initiatives section
            showSection('initiatives');
            
            // Auto-populate and show the selected initiative
            setTimeout(() => {
                populateInitiatives();
                
                // Auto-select the initiative
                const selectedCard = document.querySelector(`[onclick*="${initiativeId}"]`);
                if (selectedCard) {
                    selectedCard.click();
                }
                
                // Scroll to the initiative details
                setTimeout(() => {
                    const detailsSection = document.getElementById('selected-initiative');
                    if (detailsSection && !detailsSection.classList.contains('hidden')) {
                        detailsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }
                }, 100);
            }, 100);
        }

        function selectInitiative(initiativeId) {
            appState.selectedInitiative = initiativeId;
            const initiative = initiatives[initiativeId];
            
            // Update selection visual
            document.querySelectorAll('.initiative-card').forEach(card => card.classList.remove('selected'));
            
            // Find and select the correct card
            const cards = document.querySelectorAll('.initiative-card');
            cards.forEach(card => {
                if (card.onclick && card.onclick.toString().includes(initiativeId)) {
                    card.classList.add('selected');
                }
            });
            
            // Show initiative details
            const detailsSection = document.getElementById('selected-initiative');
            detailsSection.classList.remove('hidden');
            
            document.getElementById('selected-icon').className = initiative.icon;
            document.getElementById('selected-name').textContent = initiative.name;
            document.getElementById('selected-description').textContent = initiative.description;
            document.getElementById('selected-complexity').textContent = initiative.complexity;
            document.getElementById('selected-roi').textContent = initiative.typicalROI;
            document.getElementById('selected-timeframe').textContent = initiative.timeframe;
            
            // Count questions for this initiative
            let totalQuestions = 0;
            initiative.capabilities.forEach(capability => {
                if (capability.questions) {
                    totalQuestions += capability.questions.length;
                }
            });
            
            // Show industry examples
            const examplesContainer = document.getElementById('industry-examples');
            examplesContainer.innerHTML = `
                <h4 style="margin-bottom: 12px; color: var(--neutral-gray);">
                    Assessment Overview: ${totalQuestions} Evidence-Based Questions
                </h4>
            `;
            
            Object.entries(initiative.industryExamples).forEach(([industry, example]) => {
                examplesContainer.innerHTML += `
                    <div style="padding: 12px; background: var(--background-gray); border-radius: 8px; margin-bottom: 8px;">
                        <strong style="color: var(--primary-blue); text-transform: capitalize;">${industry}:</strong>
                        <span style="color: var(--neutral-gray-light);">${example}</span>
                    </div>
                `;
            });
            
            // Scroll to details if not from quick assessment
            if (!event || !event.currentTarget || !event.currentTarget.closest('.initiative-card')) {
                detailsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        function startAssessment() {
            if (!appState.selectedInitiative) {
                alert('Please select an initiative first.');
                return;
            }
            
            // Hide initiative selection, show assessment
            document.getElementById('initiative-grid').style.display = 'none';
            document.getElementById('selected-initiative').style.display = 'none';
            document.getElementById('assessment-container').classList.remove('hidden');
            
            // Initialize assessment
            appState.assessmentData = {};
            renderAssessmentQuestions();
            updateProgress();
        }

        function renderAssessmentQuestions() {
            const container = document.getElementById('questions-container');
            container.innerHTML = '';
            
            const initiative = initiatives[appState.selectedInitiative];
            let questionNumber = 1;
            
            initiative.capabilities.forEach(capability => {
                // Capability header
                const capabilityHeader = document.createElement('div');
                capabilityHeader.className = 'card mb-4';
                capabilityHeader.innerHTML = `
                    <div class="card-content">
                        <h3 style="color: var(--primary-blue); margin-bottom: 8px; display: flex; align-items: center; gap: 8px;">
                            <i class="fas fa-cog"></i>
                            ${capability.name}
                        </h3>
                        <p style="color: var(--neutral-gray-light); margin-bottom: 0;">
                            Required readiness level: <strong>${capability.requiredScore}%</strong> 
                            | Weight: <strong>${capability.weight}/5</strong>
                        </p>
                    </div>
                `;
                container.appendChild(capabilityHeader);
                
                // Render questions
                if (capability.questions) {
                    capability.questions.forEach(question => {
                        const questionCard = document.createElement('div');
                        questionCard.className = 'question-card fade-in';
                        questionCard.innerHTML = `
                            <div class="question-header">
                                <div class="question-number">${questionNumber}</div>
                                <div class="question-text">${question.text}</div>
                            </div>
                            <div class="question-options">
                                ${question.options.map((option, index) => `
                                    <div class="option-button" onclick="selectAnswer('${question.id}', ${index}, ${option.score})">
                                        <span class="option-text">${option.text}</span>
                                        <span class="option-score">${option.score}</span>
                                    </div>
                                `).join('')}
                            </div>
                        `;
                        container.appendChild(questionCard);
                        questionNumber++;
                    });
                }
            });
        }

        function selectAnswer(questionId, optionIndex, score) {
            // Store answer
            appState.assessmentData[questionId] = {
                optionIndex: optionIndex,
                score: score
            };
            
            // Update visual selection
            const questionCard = event.currentTarget.closest('.question-card');
            questionCard.querySelectorAll('.option-button').forEach(btn => btn.classList.remove('selected'));
            event.currentTarget.classList.add('selected');
            
            // Update progress
            updateProgress();
            
            // Check if assessment is complete
            checkAssessmentCompletion();
        }

        function updateProgress() {
            const initiative = initiatives[appState.selectedInitiative];
            if (!initiative) return;
            
            let totalQuestions = 0;
            let answeredQuestions = 0;
            
            initiative.capabilities.forEach(capability => {
                if (capability.questions) {
                    totalQuestions += capability.questions.length;
                    capability.questions.forEach(question => {
                        if (appState.assessmentData[question.id]) {
                            answeredQuestions++;
                        }
                    });
                }
            });
            
            const progress = totalQuestions > 0 ? Math.round((answeredQuestions / totalQuestions) * 100) : 0;
            appState.progress = progress;
            
            document.getElementById('progress-text').textContent = `${progress}% Complete`;
            document.getElementById('progress-fill').style.width = `${progress}%`;
        }

        function checkAssessmentCompletion() {
            const initiative = initiatives[appState.selectedInitiative];
            let totalQuestions = 0;
            let answeredQuestions = 0;
            
            initiative.capabilities.forEach(capability => {
                if (capability.questions) {
                    totalQuestions += capability.questions.length;
                    capability.questions.forEach(question => {
                        if (appState.assessmentData[question.id]) {
                            answeredQuestions++;
                        }
                    });
                }
            });
            
            const completeButton = document.getElementById('complete-assessment');
            if (answeredQuestions === totalQuestions) {
                completeButton.disabled = false;
                completeButton.classList.add('btn-success');
                completeButton.innerHTML = '<i class="fas fa-calculator"></i> Calculate Readiness Score';
            }
        }

        function calculateResults() {
            const initiative = initiatives[appState.selectedInitiative];
            let results = {
                capabilities: {},
                overallReadiness: 0,
                riskScore: 0,
                confidenceLevel: 0,
                industryRanking: 0
            };
            
            let totalWeightedScore = 0;
            let totalWeight = 0;
            let criticalGaps = 0;
            
            // Calculate capability scores
            initiative.capabilities.forEach(capability => {
                let capabilityScore = 0;
                let questionCount = 0;
                
                if (capability.questions) {
                    capability.questions.forEach(question => {
                        const answer = appState.assessmentData[question.id];
                        if (answer) {
                            capabilityScore += answer.score;
                            questionCount++;
                        }
                    });
                }
                
                const avgScore = questionCount > 0 ? Math.round(capabilityScore / questionCount) : 0;
                const weightedScore = avgScore * capability.weight;
                
                // Determine status
                let status = 'ready';
                if (avgScore < 40) {
                    status = 'critical';
                    criticalGaps++;
                } else if (avgScore < 70) {
                    status = 'caution';
                }
                
                results.capabilities[capability.name] = {
                    score: avgScore,
                    weight: capability.weight,
                    required: capability.requiredScore,
                    status: status,
                    gap: Math.max(0, capability.requiredScore - avgScore)
                };
                
                totalWeightedScore += weightedScore;
                totalWeight += capability.weight;
            });
            
            // Calculate overall metrics
            results.overallReadiness = Math.round(totalWeightedScore / totalWeight);
            results.riskScore = Math.max(0, 100 - (criticalGaps * 25 + results.overallReadiness * 0.5));
            results.confidenceLevel = Math.min(100, Object.keys(appState.assessmentData).length * 15);
            results.industryRanking = Math.min(99, Math.max(1, results.overallReadiness + Math.random() * 20 - 10));
            
            appState.results = results;
            
            // Show results
            showSection('results');
            renderResults();
        }

        function renderResults() {
            const results = appState.results;
            
            // Hide placeholder, show content
            document.getElementById('results-placeholder').style.display = 'none';
            document.getElementById('results-content').classList.remove('hidden');
            
            // Update score cards
            document.getElementById('overall-readiness').textContent = results.overallReadiness + '%';
            document.getElementById('risk-score').textContent = Math.round(results.riskScore) + '%';
            document.getElementById('confidence-level').textContent = Math.round(results.confidenceLevel) + '%';
            document.getElementById('industry-ranking').textContent = Math.round(results.industryRanking) + 'th';
            
            // Update score card colors
            updateScoreCardColors('overall-readiness', results.overallReadiness);
            updateScoreCardColors('risk-score', results.riskScore);
            updateScoreCardColors('confidence-level', results.confidenceLevel);
            
            // Render critical risks
            renderCriticalRisks();
            
            // Render recommendations
            renderRecommendations();
            
            // Render capability breakdown
            renderCapabilityBreakdown();
        }

        function updateScoreCardColors(elementId, score) {
            const element = document.getElementById(elementId);
            const card = element.closest('.score-card');
            
            // Remove existing classes
            element.classList.remove('high-score', 'medium-score', 'low-score');
            card.classList.remove('high-score', 'medium-score', 'low-score');
            
            // Add appropriate class
            if (score >= 70) {
                element.classList.add('high-score');
                card.classList.add('high-score');
            } else if (score >= 50) {
                element.classList.add('medium-score');
                card.classList.add('medium-score');
            } else {
                element.classList.add('low-score');
                card.classList.add('low-score');
            }
        }

        function renderCriticalRisks() {
            const container = document.getElementById('critical-risks');
            const results = appState.results;
            container.innerHTML = '';
            
            const criticalCapabilities = Object.entries(results.capabilities)
                .filter(([name, data]) => data.status === 'critical')
                .sort((a, b) => a[1].score - b[1].score);
            
            if (criticalCapabilities.length === 0) {
                container.innerHTML = `
                    <div class="alert alert-success">
                        <i class="fas fa-check-circle"></i>
                        <div>No critical risk factors identified. Your organization shows strong foundational capabilities.</div>
                    </div>
                `;
            } else {
                criticalCapabilities.forEach(([name, data]) => {
                    container.innerHTML += `
                        <div class="alert alert-danger">
                            <i class="fas fa-exclamation-triangle"></i>
                            <div>
                                <strong>${name}:</strong> ${data.score}% readiness (${data.required}% required)
                                <br><small>Gap of ${data.gap} points poses high implementation risk</small>
                            </div>
                        </div>
                    `;
                });
            }
        }

        function renderRecommendations() {
            const container = document.getElementById('recommendations');
            const results = appState.results;
            container.innerHTML = '';
            
            // Generate recommendations based on results
            if (results.overallReadiness >= 70) {
                container.innerHTML += `
                    <div class="alert alert-success">
                        <i class="fas fa-thumbs-up"></i>
                        <div><strong>Proceed with Implementation:</strong> Strong readiness foundation supports immediate initiative launch.</div>
                    </div>
                `;
            } else if (results.overallReadiness >= 50) {
                container.innerHTML += `
                    <div class="alert alert-warning">
                        <i class="fas fa-tools"></i>
                        <div><strong>Address Gaps First:</strong> 8-12 week capability development recommended before full implementation.</div>
                    </div>
                `;
            } else {
                container.innerHTML += `
                    <div class="alert alert-danger">
                        <i class="fas fa-stop-circle"></i>
                        <div><strong>Significant Preparation Required:</strong> 6-9 month foundational development needed before proceeding.</div>
                    </div>
                `;
            }
            
            // Add specific recommendations
            const cautionCapabilities = Object.entries(results.capabilities)
                .filter(([name, data]) => data.status === 'caution')
                .slice(0, 2);
            
            cautionCapabilities.forEach(([name, data]) => {
                container.innerHTML += `
                    <div class="alert alert-warning">
                        <i class="fas fa-lightbulb"></i>
                        <div><strong>Develop ${name}:</strong> Target ${data.required}% readiness through focused capability building.</div>
                    </div>
                `;
            });
        }

        function renderCapabilityBreakdown() {
            const container = document.getElementById('capability-breakdown');
            const results = appState.results;
            container.innerHTML = '';
            
            Object.entries(results.capabilities).forEach(([name, data]) => {
                const resultDiv = document.createElement('div');
                resultDiv.className = 'capability-result';
                resultDiv.innerHTML = `
                    <div class="capability-info">
                        <div class="capability-name">${name}</div>
                        <div class="capability-details">
                            Required: ${data.required}% | Weight: ${data.weight}/5 | Gap: ${data.gap} points
                        </div>
                    </div>
                    <div class="capability-score">
                        <div class="capability-score-value ${data.status === 'ready' ? 'status-ready' : data.status === 'caution' ? 'status-caution' : 'status-critical'}">${data.score}%</div>
                        <div class="capability-status status-${data.status}">
                            ${data.status === 'ready' ? 'Ready' : data.status === 'caution' ? 'Caution' : 'Critical'}
                        </div>
                    </div>
                `;
                container.appendChild(resultDiv);
            });
        }

        // ---------------------------------------------------------
        // Enhanced generateReport()
        // Option 3 implementation:
        // • Executive report → narrative HTML
        // • All other types   → original text output
        // ---------------------------------------------------------
        function generateReport(type = 'executive') {
            
            // Require results
            if (!appState.results || !appState.results.overallReadiness) {
                alert("Please complete an assessment before generating a report.");
                return;
            }

            const results = appState.results;
            const initiative = initiatives[appState.selectedInitiative] || { name: "N/A" };

            // Show loading state
            const reportButton = event.currentTarget;
            const originalText = reportButton.innerHTML;
            reportButton.innerHTML = '<div class="loading"><div class="spinner"></div>Generating...</div>';
            reportButton.disabled = true;

            setTimeout(() => {
                // ----------------------------------------------
                // OPTION 3 LOGIC:
                // If executive → generate full narrative HTML
                // Else → original .txt report
                // ----------------------------------------------
                if (type === 'executive') {

                    // --------------------------
                    // Narrative Report Generator
                    // --------------------------
                    const readiness = results.overallReadiness;
                    const conf = results.confidenceLevel;
                    const caps = Object.entries(results.capabilities).map(([name, data]) => ({
                        name,
                        score: data.score,
                        required: data.required,
                        status: data.status,
                        gap: data.gap,
                        narrative: data.narrative || ""
                    }));

                    function classify(score) {
                        if (score >= 70) return "Effective";
                        if (score >= 50) return "Developing";
                        return "Emerging";
                    }

                    let thesis = "";
                    if (readiness < 50) thesis = "Our analysis indicates material execution risk; remediation required before scaling.";
                    else if (readiness < 70) thesis = "The organization shows moderate readiness; targeted remediation will enable success.";
                    else thesis = "The organization is well-prepared; proceed with structured mitigations.";

                    const critical = caps.filter(c => c.score < 50);
                    const developing = caps.filter(c => c.score >= 50 && c.score < 70);
                    const effective = caps.filter(c => c.score >= 70);

                    // --------------------------
                    // Build narrative HTML report
                    // --------------------------
                    let html = `
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Executive Narrative Report - ${initiative.name}</title>
    <style>
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, Arial, sans-serif; 
            padding: 40px; 
            color: #1f2937; 
            max-width: 1200px;
            margin: 0 auto;
            background: #f8fafc;
        }
        .report-container {
            background: white;
            padding: 48px;
            border-radius: 8px;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
        }
        h1 { 
            color: #111827; 
            font-size: 28px;
            margin-bottom: 8px;
            border-bottom: 3px solid #1e3a8a;
            padding-bottom: 16px;
        }
        h2 { 
            color: #1e3a8a; 
            font-size: 20px;
            margin-top: 32px;
            margin-bottom: 16px;
        }
        .meta-info {
            color: #6b7280;
            margin-bottom: 24px;
            font-size: 14px;
        }
        table { 
            width: 100%; 
            border-collapse: collapse; 
            margin-top: 16px;
            margin-bottom: 24px;
        }
        th, td { 
            padding: 12px; 
            border-bottom: 1px solid #e5e7eb; 
            text-align: left;
            font-size: 14px;
        }
        th {
            background: #f8fafc;
            font-weight: 600;
            color: #374151;
        }
        ul {
            margin: 16px 0;
            padding-left: 24px;
        }
        li {
            margin: 8px 0;
            line-height: 1.6;
        }
        .thesis-box {
            background: #eff6ff;
            border-left: 4px solid #1e3a8a;
            padding: 16px 20px;
            margin: 20px 0;
            border-radius: 4px;
        }
        .footer {
            color: #6b7280;
            font-size: 12px;
            margin-top: 48px;
            padding-top: 24px;
            border-top: 1px solid #e5e7eb;
            text-align: center;
        }
        .readiness-score {
            font-weight: 700;
            color: #1e3a8a;
            font-size: 18px;
        }
        .status-critical { color: #dc2626; }
        .status-developing { color: #d97706; }
        .status-effective { color: #065f46; }
    </style>
</head>
<body>
    <div class="report-container">
        <h1>${initiative.name} – Transformation Readiness Executive Summary</h1>
        <div class="meta-info">Date: ${new Date().toLocaleDateString()} | Generated by TransformIQ™ Narrative Engine</div>

        <h2>Introduction</h2>
        <p>This assessment evaluates organizational readiness for <strong>${initiative.name}</strong>, identifies capability gaps, and outlines strategic actions to maximize transformation value.</p>

        <h2>Thesis</h2>
        <div class="thesis-box">
            <p><span class="readiness-score">Overall Readiness: ${readiness}%</span></p>
            <p>${thesis}</p>
        </div>

        <h2>Key Findings</h2>
        <ul>
`;

                    if (critical.length) {
                        html += `<li><strong>Critical Gaps (${critical.length})</strong><ul>`;
                        critical.forEach(c => html += `<li class="status-critical"><strong>${c.name}</strong> (${c.score}%) – ${c.narrative || "Critical gap identified."}</li>`);
                        html += `</ul></li>`;
                    }

                    if (developing.length) {
                        html += `<li><strong>Developing Capabilities (${developing.length})</strong><ul>`;
                        developing.forEach(c => html += `<li class="status-developing"><strong>${c.name}</strong> (${c.score}%)</li>`);
                        html += `</ul></li>`;
                    }

                    if (effective.length) {
                        html += `<li><strong>Effective Areas (${effective.length})</strong><ul>`;
                        effective.forEach(c => html += `<li class="status-effective"><strong>${c.name}</strong> (${c.score}%)</li>`);
                        html += `</ul></li>`;
                    }

                    html += `</ul>

        <h2>Insights by Transformation Lever</h2>
        <table>
            <thead>
                <tr>
                    <th>Lever</th>
                    <th>Readiness</th>
                    <th>Implication</th>
                    <th>Strategic Opportunity</th>
                </tr>
            </thead>
            <tbody>
`;

                    caps.forEach(c => {
                        const implication = c.narrative ||
                            (c.score < 50 ? "Critical gaps and unclear dependencies." :
                             c.score < 70 ? "Partially developed capability with improvement needed." :
                                            "Strong capability with opportunity to scale.");

                        const opp = c.score < 50 ? "Prioritize remediation and establish strong governance." :
                                    c.score < 70 ? "Integrate capability with enterprise KPIs." :
                                                   "Leverage to accelerate strategic value.";

                        const statusClass = c.score < 50 ? 'status-critical' : c.score < 70 ? 'status-developing' : 'status-effective';

                        html += `<tr>
                            <td><strong>${c.name}</strong></td>
                            <td class="${statusClass}">${c.score}% – ${classify(c.score)}</td>
                            <td>${implication}</td>
                            <td>${opp}</td>
                        </tr>`;
                    });

                    html += `
            </tbody>
        </table>

        <h2>Strategic Implications</h2>
        <ul>
            <li><strong>Transformation Risk:</strong> ${readiness < 50 || critical.length >= 3 ? "High" : readiness < 70 ? "Moderate" : "Low"}.</li>
            <li><strong>Investment Effectiveness:</strong> ${caps.some(c => /revenue/i.test(c.name) && c.score >= 50)
                ? "Investments increasingly tied to measurable outcomes."
                : "Current investment linkage to revenue is limited."}</li>
            <li><strong>Execution Reliability:</strong> ${caps.some(c => /stakeholder/i.test(c.name) && c.score < 50)
                ? "Fragmented alignment increases execution risk."
                : "Execution reliability improving with governance."}</li>
            <li><strong>Customer & Revenue Impact:</strong> ${caps.some(c => /customer/i.test(c.name) && c.score < 50)
                ? "Customer experience fragmentation poses revenue risk."
                : "Customer and revenue impact manageable."}</li>
        </ul>

        <h2>Conclusion & Recommendations</h2>
        <p>The organization is <strong>${readiness >= 70 ? "well-positioned" : readiness >= 50 ? "partially ready" : "not yet ready"}</strong> to scale ${initiative.name}. Remediation of high-leverage gaps will significantly strengthen transformation outcomes.</p>

        <ol>
            <li>Prioritize remediation of: ${critical.map(c => c.name).join(", ") || "N/A"}.</li>
            <li>Link technology initiatives to measurable KPIs.</li>
            <li>Establish cross-functional governance forums.</li>
            <li>Enhance dependency mapping and execution sequencing.</li>
        </ol>

        <div class="footer">
            <p>Generated by TransformIQ™ Narrative Engine</p>
            <p>© ${new Date().getFullYear()} - Enterprise Transformation Consulting</p>
        </div>
    </div>
</body>
</html>
`;

                    // -------------- Download HTML --------------
                    const blob = new Blob([html], { type: "text/html" });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement("a");
                    a.href = url;
                    a.download = `TransformIQ_Executive_Narrative_Report_${new Date().toISOString().split("T")[0]}.html`;
                    document.body.appendChild(a);
                    a.click();
                    a.remove();
                    URL.revokeObjectURL(url);

                    // Reset button and show success
                    reportButton.innerHTML = originalText;
                    reportButton.disabled = false;
                    showSuccessMessage('Executive narrative report has been downloaded.');

                    return;
                }

                // ----------------------------------------------
                // NON-EXECUTIVE REPORTS → Original behavior
                // ----------------------------------------------
                let reportContent = `TRANSFORMIQ™ READINESS ASSESSMENT REPORT\n`;
                reportContent += `==========================================\n\n`;
                reportContent += `Initiative: ${initiative.name}\n`;
                reportContent += `Date: ${new Date().toLocaleDateString()}\n`;
                reportContent += `Overall Readiness: ${results.overallReadiness}%\n`;
                reportContent += `Risk Assessment: ${Math.round(results.riskScore || 0)}%\n`;
                reportContent += `Confidence Level: ${Math.round(results.confidenceLevel || 0)}%\n\n`;

                reportContent += `EXECUTIVE SUMMARY\n`;
                reportContent += `================\n`;
                if (results.overallReadiness >= 70) {
                    reportContent += `RECOMMENDATION: PROCEED - Organization demonstrates strong readiness.\n\n`;
                } else if (results.overallReadiness >= 50) {
                    reportContent += `RECOMMENDATION: PROCEED WITH CAUTION - Address identified gaps before full implementation.\n\n`;
                } else {
                    reportContent += `RECOMMENDATION: DELAY - Significant capability development required.\n\n`;
                }

                reportContent += `CAPABILITY BREAKDOWN\n`;
                reportContent += `===================\n`;
                Object.entries(results.capabilities).forEach(([name, data]) => {
                    reportContent += `${name}: ${data.score}% (Required: ${data.required}%) - ${data.status.toUpperCase()}\n`;
                });

                reportContent += `\n\nGenerated by TransformIQ™ Readiness Intelligence Platform\n`;
                reportContent += `© ${new Date().getFullYear()} - Enterprise Transformation Consulting\n`;

                const blob = new Blob([reportContent], { type: "text/plain" });
                const url = URL.createObjectURL(blob);
                const a = document.createElement("a");
                a.href = url;
                a.download = `TransformIQ_${type}_Report_${new Date().toISOString().split('T')[0]}.txt`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);

                // Reset button and show success
                reportButton.innerHTML = originalText;
                reportButton.disabled = false;
                showSuccessMessage(`${type.charAt(0).toUpperCase() + type.slice(1)} assessment report has been downloaded.`);

            }, 2000);
        }

        function scheduleConsultation() {
            alert('Feature coming soon: Schedule a strategic consultation to discuss your assessment results and implementation planning.');
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize default view
            showSection('dashboard');
            
            // Add smooth scrolling for all anchor links
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const target = document.querySelector(this.getAttribute('href'));
                    if (target) {
                        target.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                    }
                });
            });
            
            // Add keyboard navigation
            document.addEventListener('keydown', function(e) {
                if (e.altKey) {
                    switch(e.key) {
                        case '1':
                            showSection('dashboard');
                            break;
                        case '2':
                            showSection('initiatives');
                            break;
                        case '3':
                            showSection('results');
                            break;
                        case '4':
                            showSection('reports');
                            break;
                        case '5':
                            if (appState.adminMode) showSection('admin');
                            break;
                    }
                }
            });
        });
    </script>
</body>
</html>(--primary-blue);" id="total-questions">--</div>
                                            <div style="font-size: 12px; color: var(--neutral-gray-light);">Total Questions</div>
                                        </div>
                                        <div style="text-align: center; padding: 16px; background: var(--background-gray); border-radius: 8px;">
                                            <div style="font-size: 24px; font-weight: 700; color: varhero-stat-value">200+</span>
                            <span class="hero-stat-label">Validated Implementations</span>
                        </div>
                        <div class="hero-stat">
                            <span class="